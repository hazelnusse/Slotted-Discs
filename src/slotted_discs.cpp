#include "slotted_discs.h"

int eomwrapper(double t, const double x[6], double f[6], void * params)
{
  SlottedDiscs * p = (SlottedDiscs *) params;
  // Assign the states of the SlottedDiscs object
  p->setState(x);
  // Evaluate the RHS of the ODE's representing the equations of motion
  p->eoms();
  // Assign the right hand sides of the ODE's to the array passed
  f[0] = p->q1p;
  f[1] = p->q2p;
  f[2] = p->q3p;
  f[3] = p->q4p;
  f[4] = p->q5p;
  f[5] = p->wp;
  // Return the status
  return GSL_SUCCESS;
} // eomwrapper()

ostream &operator<<(ostream &file, const SlottedDiscs * discs)
{
  file.write((char *) &(discs->t), sizeof discs->t);
  file.write((char *) &discs->q1, sizeof discs->q1);
  file.write((char *) &discs->q2, sizeof discs->q2);
  file.write((char *) &discs->q3, sizeof discs->q3);
  file.write((char *) &discs->q4, sizeof discs->q4);
  file.write((char *) &discs->q5, sizeof discs->q5);
  file.write((char *) &discs->q1p, sizeof discs->q1p);
  file.write((char *) &discs->q2p, sizeof discs->q2p);
  file.write((char *) &discs->q3p, sizeof discs->q3p);
  file.write((char *) &discs->q4p, sizeof discs->q4p);
  file.write((char *) &discs->q5p, sizeof discs->q5p);
  file.write((char *) &discs->w, sizeof discs->w);
  file.write((char *) &discs->w1, sizeof discs->w1);
  file.write((char *) &discs->w2, sizeof discs->w2);
  file.write((char *) &discs->w3, sizeof discs->w3);
  file.write((char *) &(discs->no_cb), sizeof discs->no_cb);
  file.write((char *) &(discs->no_so), sizeof discs->no_so);
  file.write((char *) &(discs->ke), sizeof discs->ke);
  file.write((char *) &(discs->pe), sizeof discs->pe);
  file.write((char *) &(discs->te), sizeof discs->te);
  file.write((char *) &(discs->H), sizeof discs->H);
  file.write((char *) &(discs->p), sizeof discs->p);
  file.write((char *) &(discs->fx), sizeof discs->fx);
  file.write((char *) &(discs->fay), sizeof discs->fay);
  file.write((char *) &(discs->faz), sizeof discs->faz);
  file.write((char *) &(discs->fby), sizeof discs->fby);
  file.write((char *) &(discs->fbz), sizeof discs->fbz);
  file.write((char *) &(discs->a_so), sizeof discs->a_so);
  return file;
} // operator <<

void setParams(DiscParams * p, double ma, double mb, double ra, double rb, double l, double alpha, double g) 
{
  double Ia = ma*ra*ra/4.0;
  double Ja = ma*ra*ra/2.0;
  double Ib = mb*rb*rb/4.0;
  double Jb = mb*rb*rb/2.0;
  p->m = ma + mb;
  p->ra = ra;
  p->rb = rb;
  p->l = l;
  p->g = 9.81;
  p->alpha = alpha;
  p->k = l*mb/(ma+mb);
  p->Ixx = Ia + Ib*pow(cos(alpha),2) + Jb*pow(sin(alpha),2) + mb*pow(l,2)*(ma*mb/
  pow((ma+mb),2)+pow((1-mb/(ma+mb)),2));
  p->Iyy = Ja + Jb + pow(sin(alpha),2)*(Ib-Jb) + mb*pow(l,2)*(ma*mb/pow((ma+mb),
  2)+pow((1-mb/(ma+mb)),2));
  p->Izz = Ia + Ib + mb*pow(l,2)*pow((1-mb/(ma+mb)),2) + mb*pow(l,2)*(-1+mb/(ma+
  mb))*(1-mb/(ma+mb));
  p->Ixy = sin(alpha)*cos(alpha)*(Ib-Jb);
} // setParams

void SlottedDiscs::writeRecord_dt(void) const
{
  ofstream fp("./record.py", ios::out);
  fp << "#!/usr/bin/env python" << endl;
  fp << "import numpy as np" << endl;
  fp << "record_dt = np.dtype([('t', np.float64), " <<
        "('q1', np.float64), " <<
        "('q2', np.float64), " <<
        "('q3', np.float64), " <<
        "('x', np.float64), " <<
        "('y', np.float64), " <<
        "('q1p', np.float64), " <<
        "('q2p', np.float64), " <<
        "('q3p', np.float64), " <<
        "('q4p', np.float64), " <<
        "('q5p', np.float64), " <<
        "('w', np.float64), " <<
        "('w1', np.float64), " <<
        "('w2', np.float64), " <<
        "('w3', np.float64), " <<
        "('cbx', np.float64), " <<
        "('cby', np.float64), " <<
        "('cbz', np.float64), " <<
        "('sox', np.float64), " <<
        "('soy', np.float64), " <<
        "('soz', np.float64), " <<
        "('ke', np.float64), " <<
        "('pe', np.float64), " <<
        "('te', np.float64), " <<
        "('H1', np.float64), " <<
        "('H2', np.float64), " <<
        "('H3', np.float64), " <<
        "('p1', np.float64), " <<
        "('p2', np.float64), " <<
        "('p3', np.float64), " <<
        "('fx', np.float64), " <<
        "('fay', np.float64), " <<
        "('faz', np.float64), " <<
        "('fby', np.float64), " <<
        "('fbz', np.float64), " <<
        "('aso1', np.float64), " <<
        "('aso2', np.float64), " <<
        "('aso3', np.float64)])" <<
        endl;
  fp.close();
} // writeRecord_dt()

SlottedDiscs::SlottedDiscs()
{
  // Default parameters
  DiscParams * p = new DiscParams;
  double ma, mb;
  ma = mb = 2.0;
  ra = rb = .1;
  l = sqrt(2.0)*ra;
  g = 9.81;
  alpha = M_PI/2.0;
  setParams(p, ma, mb, ra, rb, l, alpha, g);
  setParameters(p);
  delete p;

  // Set state
  q1 = 0.0;
  q2 = M_PI/4.0;
  q3 = M_PI/2.0;
  q4 = q5 = 0.0;
  w = 1.0;

  // Set integration settings
  t = 0.0;
  tf = 10.0;
  h = 0.001;
  fps = 1000;
  T = gsl_odeiv_step_rk8pd;
  s = gsl_odeiv_step_alloc(T, 6);
  c = gsl_odeiv_control_y_new(1e-6, 1e-9);
  e = gsl_odeiv_evolve_alloc(6);
  sys.function = eomwrapper;
  sys.jacobian = NULL;
  sys.dimension = 6;
  sys.params = this;

  for (int i = 0; i < Z_MAX; ++i)
    z[i] = 0.0;

  // Camera settings
  theta = M_PI / 4.0;
  phi = 0.0;
  d = 1.0;
  ctx = .35;
  cty = .35; 
  ctz = 0.0;
  
  // Constants
  evalConstants();
  eoms();
  computeOutputs();

  // Write the file which holds the numpy record data type so that plotting is
  // easy
  writeRecord_dt();
 
} // constructor

SlottedDiscs::~SlottedDiscs()
{
  gsl_odeiv_evolve_free(e);
  gsl_odeiv_control_free(c);
  gsl_odeiv_step_free(s);
} // destructor

void SlottedDiscs::printState(void) const
{
  cout.setf(ios::right, ios::adjustfield);
  cout.setf(ios::scientific, ios::floatfield);
  cout.setf(ios::adjustfield, ios::right);
  cout.precision(9);
  cout.width(18);
  cout << q1;
  cout.width(18);
  cout << q2;
  cout.width(18);
  cout << q3;
  cout.width(18);
  cout << q4;
  cout.width(18);
  cout << q5;
  cout.width(18);
  cout << w3;
  cout << endl;
} // printState()

void SlottedDiscs::printEnergy(void) const
{
  cout.setf(ios::scientific, ios::floatfield);
  cout.setf(ios::adjustfield, ios::right);
  cout.precision(9);
  cout.width(18);
  cout << ke;
  cout.width(18);
  cout << pe;
  cout.width(18);
  cout << te;
  cout << endl;
} // printEnergy()

void SlottedDiscs::printParameters() const
{
  cout.setf(ios::scientific, ios::floatfield);
  cout.setf(ios::adjustfield, ios::right);
  cout.precision(9);
  cout << "ra = " << ra << endl << "rb = " << rb << endl;
  cout << "m = " << m << endl;
  cout << "Ixx = " << Ixx << endl << "Iyy = " << Iyy << endl;
  cout << "Izz = " << Izz << endl << "Ixy = " << Ixy << endl;
  cout << "alpha = " << alpha << endl << "l = " << l << endl;
  cout << "k = " << k << endl;
  cout << "g = " << g << endl;
} // printParameters()

void SlottedDiscs::evalConstants(void)
{
  z[16] = sin(alpha);
  z[15] = cos(alpha);
  z[340] = k*m*z[16];
  z[339] = g*k*m;
  z[39] = pow(l,2) + pow(ra,2);
  z[1] = cos(phi);
  z[2] = sin(phi);
  z[3] = sin(theta);
  z[4] = z[2]*z[3];
  z[5] = z[1]*z[3];
  z[6] = cos(theta);
  z[7] = z[2]*z[6];
  z[8] = z[1]*z[6];
  z[40] = l*ra;
  z[154] = Iyy*z[15];
  z[155] = Ixy*z[15];
  z[156] = Ixx*z[16];
  z[157] = k*z[16];
  z[158] = k*z[15];
  z[161] = Ixy*z[16];
  z[170] = ra*rb;
  z[171] = l*rb;
  z[312] = Izz*z[15];
  z[313] = ra*z[16];
  z[314] = ra*z[15];
  z[335] = m*z[16];
  z[336] = m*z[15];
  z[338] = g*m;
  z[341] = k*m;
  z[342] = k*m*z[15];
  z[343] = Izz*z[16];
  z[344] = m*ra;
  z[345] = g*m*ra;
} //evalConstants()

void SlottedDiscs::eoms(void)
{
  z[13] = cos(q3);
  z[11] = cos(q2);
  z[20] = z[11]*z[13];
  z[12] = sin(q2);
  z[14] = sin(q3);
  z[19] = z[11]*z[14];
  z[26] = z[15]*z[12] + z[16]*z[19];
  z[27] = 1 - pow(z[26],2);
  z[28] = pow(z[27],0.5);
  z[29] = 1/z[28];
  z[31] = rb*z[29];
  z[30] = z[26]/z[28];
  z[32] = rb*z[30];
  z[17] = z[12]*z[14];
  z[24] = z[15]*z[11] - z[16]*z[17];
  z[37] = z[11]*z[26] - z[12]*z[24];
  z[41] = z[39] + pow(z[31],2) + pow(z[32],2) + 2*z[40]*z[13] + 2*ra*z[32]*
  z[37] - 2*l*z[20]*z[31] - 2*ra*z[11]*z[31] - 2*z[26]*z[31]*z[32];
  z[42] = pow(z[41],0.5);
  z[45] = z[31]/z[42];
  z[44] = l/z[42];
  z[43] = ra/z[42];
  z[52] = z[20]*z[45] - z[44] - z[13]*z[43];
  z[46] = z[32]/z[42];
  z[51] = z[16]*z[46] + z[14]*z[43] - z[19]*z[45];
  z[53] = (z[13]*z[52]-z[14]*z[51])/z[11];
  q1p = w*z[53];
  z[54] = z[13]*z[51] + z[14]*z[52];
  q2p = w*z[54];
  z[55] = z[12]*z[45] - z[15]*z[46];
  z[56] = tan(q2);
  z[57] = z[55] - z[56]*(z[13]*z[52]-z[14]*z[51]);
  q3p = w*z[57];
  z[9] = cos(q1);
  q4p = -ra*z[9]*q3p;
  z[10] = sin(q1);
  q5p = -ra*z[10]*q3p;
  z[25] = z[16]*z[12] - z[15]*z[19];
  z[22] = z[16]*z[13];
  z[160] = m*(k*z[25]*z[46]+k*z[12]*z[14]*z[43]-ra*z[12]*(z[14]*z[44]-z[22]*
  z[46]));
  z[66] = k*z[46];
  z[65] = k*(z[14]*z[43]-z[19]*z[45]);
  z[64] = k*z[12]*z[45];
  z[34] = z[11]*z[24] + z[12]*z[26];
  z[62] = ra*(z[12]*z[45]-z[34]*z[46]);
  z[63] = ra*(z[14]*z[44]-z[22]*z[46]);
  z[21] = z[15]*z[13];
  z[23] = z[15]*z[17] + z[16]*z[11];
  z[33] = z[11]*z[23] + z[12]*z[25];
  z[159] = z[16]*z[46]*(2*z[155]*z[46]-z[156]*z[46]-2*Ixx*z[14]*z[43]-2*Ixy*
  z[12]*z[45]) + z[14]*z[43]*(2*z[155]*z[46]+2*Ixx*z[19]*z[45]-2*Ixy*z[12]*
  z[45]-Ixx*z[14]*z[43]) - Iyy*pow(z[12],2)*pow(z[45],2) - Izz*pow(z[20],2)*
  pow(z[45],2) - z[154]*z[46]*(z[15]*z[46]-2*z[12]*z[45]) - Izz*z[13]*z[43]*(
  z[13]*z[43]-2*z[20]*z[45]) - Izz*z[44]*(z[44]+2*z[13]*z[43]-2*z[20]*z[45]) - 
  z[19]*z[45]*(2*z[155]*z[46]+Ixx*z[19]*z[45]-2*z[156]*z[46]-2*Ixy*z[12]*
  z[45]) - m*(k*z[46]*z[66]+z[157]*z[46]*z[65]+k*z[12]*z[45]*z[64]+k*z[12]*
  z[13]*z[45]*z[62]+k*z[65]*(z[14]*z[43]-z[19]*z[45])+ra*z[62]*(z[12]*z[45]-
  z[34]*z[46])+ra*z[63]*(z[14]*z[44]-z[22]*z[46])+z[157]*z[66]*(z[14]*z[43]-
  z[19]*z[45])+ra*z[13]*z[64]*(z[12]*z[45]-z[34]*z[46])-z[158]*z[46]*z[64]-k*
  z[21]*z[46]*z[62]-k*z[33]*z[46]*z[63]-z[158]*z[12]*z[45]*z[66]-k*z[63]*(
  z[14]*z[43]-z[19]*z[45])-ra*z[65]*(z[14]*z[44]-z[22]*z[46])-ra*z[21]*z[66]*(
  z[12]*z[45]-z[34]*z[46])-ra*z[33]*z[66]*(z[14]*z[44]-z[22]*z[46]));
  z[163] = z[160]/z[159];
  z[36] = z[11]*z[25] - z[12]*z[23];
  z[67] = w*z[45];
  z[68] = w*z[43];
  z[18] = z[12]*z[13];
  z[69] = w*z[44];
  z[70] = w*z[46];
  z[108] = z[67]*(z[12]*z[68]+z[18]*z[69]-z[24]*z[70]);
  z[109] = z[67]*(z[14]*z[69]-z[22]*z[70]);
  z[72] = z[24]*z[26];
  z[74] = z[72]/pow(z[27],0.5);
  z[76] = z[74]/pow(z[28],2);
  z[78] = rb*z[76];
  z[80] = (z[24]*z[28]+z[26]*z[74])/pow(z[28],2);
  z[82] = rb*z[80];
  z[84] = -z[15]*z[12] - z[16]*z[19];
  z[86] = z[12]*(z[26]+z[84]);
  z[88] = 2*z[31]*z[78] + 2*z[32]*z[82] + 2*l*z[18]*z[31] + 2*ra*z[12]*z[31] + 
  2*ra*z[37]*z[82] - 2*l*z[20]*z[78] - 2*ra*z[11]*z[78] - 2*ra*z[32]*z[86] - 
  2*z[24]*z[31]*z[32] - 2*z[26]*z[31]*z[82] - 2*z[26]*z[32]*z[78];
  z[90] = z[88]/pow(z[41],0.5);
  z[104] = (z[32]*z[90]-2*z[42]*z[82])/pow(z[42],2);
  z[106] = w*z[104];
  z[71] = z[16]*z[20];
  z[73] = z[26]*z[71];
  z[75] = z[73]/pow(z[27],0.5);
  z[77] = z[75]/pow(z[28],2);
  z[79] = rb*z[77];
  z[81] = (z[26]*z[75]+z[28]*z[71])/pow(z[28],2);
  z[83] = rb*z[81];
  z[85] = z[16]*z[18];
  z[87] = z[11]*z[71] + z[12]*z[85];
  z[89] = 2*z[31]*z[79] + 2*z[32]*z[83] + 2*l*z[19]*z[31] + 2*ra*z[32]*z[87] + 
  2*ra*z[37]*z[83] - 2*z[40]*z[14] - 2*l*z[20]*z[79] - 2*ra*z[11]*z[79] - 2*
  z[26]*z[31]*z[83] - 2*z[26]*z[32]*z[79] - 2*z[31]*z[32]*z[71];
  z[91] = z[89]/pow(z[41],0.5);
  z[105] = (z[32]*z[91]-2*z[42]*z[83])/pow(z[42],2);
  z[107] = w*z[105];
  z[114] = 0.5*z[106]*q2p + 0.5*z[107]*q3p;
  z[96] = ra*z[90]/pow(z[42],2);
  z[98] = w*z[96];
  z[97] = ra*z[91]/pow(z[42],2);
  z[99] = w*z[97];
  z[112] = 0.5*z[98]*q2p + 0.5*z[99]*q3p;
  z[111] = z[68]*q3p;
  z[92] = (z[31]*z[90]-2*z[42]*z[78])/pow(z[42],2);
  z[94] = w*z[92];
  z[93] = (z[31]*z[91]-2*z[42]*z[79])/pow(z[42],2);
  z[95] = w*z[93];
  z[110] = -0.5*z[94]*q2p - 0.5*z[95]*q3p;
  z[100] = l*z[90]/pow(z[42],2);
  z[102] = w*z[100];
  z[101] = l*z[91]/pow(z[42],2);
  z[103] = w*z[101];
  z[113] = 0.5*z[102]*q2p + 0.5*z[103]*q3p;
  z[38] = z[11]*z[20] + z[12]*z[18];
  z[152] = pow(w,2)*z[66]*(z[20]*z[45]-z[44]-z[38]*z[43]);
  z[143] = pow(w,2)*z[11]*z[45]*z[65];
  z[144] = pow(w,2)*z[45]*z[62];
  z[150] = pow(w,2)*(z[15]*z[46]*z[64]-z[16]*z[46]*z[65]-z[12]*z[45]*z[64]);
  z[153] = pow(w,2)*z[66]*(z[26]*z[45]-z[46]-z[37]*z[43]);
  z[35] = z[12]*z[20] - z[11]*z[18];
  z[139] = k*z[104];
  z[141] = w*z[139];
  z[140] = k*z[105];
  z[142] = w*z[140];
  z[151] = -0.5*z[141]*q2p - 0.5*z[142]*q3p;
  z[136] = k*(z[19]*z[93]+2*z[13]*z[43]-2*z[20]*z[45]-z[14]*z[97]);
  z[138] = w*z[136];
  z[135] = k*(z[14]*z[96]-2*z[17]*z[45]-z[19]*z[92]);
  z[137] = w*z[135];
  z[149] = pow(w,2)*z[44]*z[64] + pow(w,2)*z[13]*z[43]*z[64] + 0.5*z[138]*q3p - 
  pow(w,2)*z[20]*z[45]*z[64] - 0.5*z[137]*q2p;
  z[132] = k*z[12]*z[93];
  z[134] = w*z[132];
  z[131] = k*(2*z[11]*z[45]-z[12]*z[92]);
  z[133] = w*z[131];
  z[148] = pow(w,2)*z[44]*z[65] + 0.5*z[134]*q3p - pow(w,2)*z[44]*z[63] - 0.5*
  z[133]*q2p;
  z[120] = z[11]*(z[26]+z[84]);
  z[122] = ra*(z[34]*z[104]+2*z[11]*z[45]-2*z[46]*z[120]-z[12]*z[92]);
  z[124] = w*z[122];
  z[121] = z[12]*z[71] - z[11]*z[85];
  z[123] = ra*(z[34]*z[105]-2*z[46]*z[121]-z[12]*z[93]);
  z[125] = w*z[123];
  z[145] = pow(w,2)*z[43]*z[65] + pow(w,2)*z[11]*z[45]*z[63] - pow(w,2)*z[43]*
  z[63] - pow(w,2)*z[37]*z[46]*z[63] - 0.5*z[124]*q2p - 0.5*z[125]*q3p;
  z[127] = ra*(z[14]*z[100]-z[22]*z[104]);
  z[129] = w*z[127];
  z[126] = z[16]*z[14];
  z[128] = ra*(z[14]*z[101]-2*z[13]*z[44]-2*z[46]*z[126]-z[22]*z[105]);
  z[130] = w*z[128];
  z[146] = pow(w,2)*z[43]*z[62] + pow(w,2)*z[13]*z[44]*z[62] + pow(w,2)*z[37]*
  z[46]*z[62] + 0.5*z[129]*q2p + 0.5*z[130]*q3p;
  z[115] = w*z[62];
  z[147] = -pow(w,2)*z[22]*z[46]*z[63] - pow(w,2)*z[34]*z[46]*z[62] - z[115]*
  q3p;
  z[162] = Izz*pow(w,2)*z[36]*z[43]*z[46]*(z[44]+z[13]*z[43]-z[20]*z[45]) + 
  pow(w,2)*z[22]*z[43]*z[46]*(z[154]*z[46]+Ixy*z[19]*z[45]-z[161]*z[46]-Ixy*
  z[14]*z[43]-Iyy*z[12]*z[45]) + pow(w,2)*z[11]*z[14]*z[44]*z[45]*(z[154]*
  z[46]+Ixy*z[19]*z[45]-z[161]*z[46]-Ixy*z[14]*z[43]-Iyy*z[12]*z[45]) + z[12]*
  z[45]*(Ixy*z[13]*z[108]+Ixy*z[17]*z[109]+Iyy*z[11]*z[109]+z[161]*z[114]+Ixy*
  z[14]*z[112]-z[154]*z[114]-Ixy*z[13]*z[111]-Iyy*z[12]*z[110]) + z[14]*z[43]*(
  Ixx*z[13]*z[108]+Ixx*z[17]*z[109]+Ixy*z[11]*z[109]+z[156]*z[114]+Ixx*z[14]*
  z[112]+Ixx*z[19]*z[110]-z[155]*z[114]-Ixx*z[13]*z[111]-Ixy*z[12]*z[110]) + 
  z[20]*z[45]*(Izz*z[14]*z[108]+z[16]*pow(w,2)*z[46]*(z[154]*z[46]+Ixy*z[19]*
  z[45]-z[161]*z[46]-Ixy*z[14]*z[43]-Iyy*z[12]*z[45])-Izz*z[18]*z[109]-Izz*
  z[113]-Izz*z[13]*z[112]-Izz*z[14]*z[111]-Izz*z[20]*z[110]) + z[16]*z[46]*(
  Ixx*z[13]*z[108]+Ixx*z[17]*z[109]+Ixy*z[11]*z[109]+Ixy*pow(w,2)*z[19]*z[44]*
  z[45]+Izz*pow(w,2)*z[12]*z[45]*(z[44]+z[13]*z[43]-z[20]*z[45])+z[156]*
  z[114]+Ixx*z[14]*z[112]+Ixx*z[19]*z[110]-2*z[155]*z[114]-Ixx*z[13]*z[111]-
  Ixy*z[12]*z[110]) - Izz*pow(w,2)*z[25]*z[45]*z[46]*(z[44]+z[13]*z[43]-z[20]*
  z[45]) - pow(w,2)*z[11]*z[22]*z[45]*z[46]*(z[154]*z[46]+Ixy*z[19]*z[45]-
  z[161]*z[46]-Ixy*z[14]*z[43]-Iyy*z[12]*z[45]) - Izz*z[44]*(z[14]*z[108]-
  z[18]*z[109]-z[113]-z[13]*z[112]-z[14]*z[111]-z[20]*z[110]) - z[13]*z[43]*(
  Izz*z[14]*z[108]+z[16]*pow(w,2)*z[46]*(z[154]*z[46]+Ixy*z[19]*z[45]-z[161]*
  z[46]-Ixy*z[14]*z[43]-Iyy*z[12]*z[45])-Izz*z[18]*z[109]-Izz*z[113]-Izz*
  z[13]*z[112]-Izz*z[14]*z[111]-Izz*z[20]*z[110]) - z[19]*z[45]*(Ixx*z[13]*
  z[108]+Ixx*z[17]*z[109]+Ixy*z[11]*z[109]+pow(w,2)*z[44]*(z[154]*z[46]+Ixy*
  z[19]*z[45]-Ixy*z[14]*z[43]-Iyy*z[12]*z[45])+z[156]*z[114]+Ixx*z[14]*z[112]+
  Ixx*z[19]*z[110]-z[155]*z[114]-2*Ixy*z[12]*z[110]-Ixx*z[13]*z[111]) - z[15]*
  z[46]*(Ixy*z[13]*z[108]+Ixy*z[17]*z[109]+Iyy*z[11]*z[109]+Izz*pow(w,2)*
  z[19]*z[45]*(z[44]+z[13]*z[43]-z[20]*z[45])+Ixy*z[14]*z[112]+Ixy*z[19]*
  z[110]-Izz*pow(w,2)*z[14]*z[43]*(z[44]+z[13]*z[43]-z[20]*z[45])-z[154]*
  z[114]-Ixy*z[13]*z[111]-Iyy*z[12]*z[110]) - m*(z[157]*z[12]*z[45]*z[152]+k*
  z[12]*z[13]*z[45]*z[143]+k*z[12]*z[17]*z[45]*z[144]+ra*z[12]*z[22]*z[45]*
  z[152]+ra*z[143]*(z[12]*z[45]-z[34]*z[46])+z[158]*z[152]*(z[14]*z[43]-z[19]*
  z[45])+ra*z[11]*z[144]*(z[14]*z[44]-z[22]*z[46])+ra*z[14]*z[150]*(z[12]*
  z[45]-z[34]*z[46])+ra*z[14]*z[153]*(z[12]*z[45]-z[34]*z[46])+ra*z[35]*
  z[153]*(z[14]*z[44]-z[22]*z[46])+k*z[46]*z[151]+z[157]*z[46]*z[149]+z[158]*
  z[46]*z[148]+k*z[21]*z[46]*z[145]+k*z[33]*z[46]*z[146]+k*z[36]*z[46]*z[147]+
  k*z[12]*z[14]*z[45]*z[147]+k*(z[14]*z[43]-z[19]*z[45])*z[146]+k*(z[14]*
  z[43]-z[19]*z[45])*z[149]+z[157]*(z[14]*z[43]-z[19]*z[45])*z[151]-k*z[21]*
  z[46]*z[143]-k*z[23]*z[46]*z[144]-ra*z[14]*z[34]*z[44]*z[152]-k*z[11]*
  z[144]*(z[14]*z[43]-z[19]*z[45])-k*z[12]*z[45]*z[148]-z[158]*z[12]*z[45]*
  z[151]-k*z[12]*z[13]*z[45]*z[145]-ra*(z[12]*z[45]-z[34]*z[46])*z[145]-ra*(
  z[14]*z[44]-z[22]*z[46])*z[146]-ra*(z[14]*z[44]-z[22]*z[46])*z[149]-ra*
  z[13]*(z[12]*z[45]-z[34]*z[46])*z[148]-ra*z[21]*(z[12]*z[45]-z[34]*z[46])*
  z[151]-ra*z[33]*(z[14]*z[44]-z[22]*z[46])*z[151]);
  z[164] = z[162]/z[159];
  wp = -g*z[163] - z[164];
} // eoms()

void SlottedDiscs::computeOutputs(void)
{
  fx = -m*(z[46]*z[152]+z[12]*z[43]*z[144]+z[18]*z[44]*z[144]+z[20]*z[45]*
  z[150]+z[20]*z[45]*z[153]+z[22]*z[46]*z[143]+z[37]*z[43]*z[152]+z[43]*
  z[147]+z[13]*z[44]*z[147]+z[37]*z[46]*z[147]+z[15]*z[46]*(z[65]*wp+z[149])+
  z[36]*z[43]*(z[66]*wp+z[151])+z[16]*z[46]*(z[64]*wp-z[148])+z[12]*z[45]*(
  z[63]*wp-z[146])+z[14]*z[43]*(z[64]*wp-z[148])+z[22]*z[46]*(z[62]*wp-z[145])-
  z[44]*z[150]-z[44]*z[153]-z[13]*z[43]*z[150]-z[14]*z[44]*z[143]-z[24]*z[46]*
  z[144]-z[26]*z[45]*z[152]-z[38]*z[43]*z[153]-z[11]*z[45]*z[147]-z[12]*z[45]*(
  z[65]*wp+z[149])-z[25]*z[45]*(z[66]*wp+z[151])-z[14]*z[44]*(z[62]*wp-z[145])-
  z[19]*z[45]*(z[64]*wp-z[148])-z[34]*z[46]*(z[63]*wp-z[146]));
  z[337] = m*z[25]*z[46]*z[150] + m*z[25]*z[46]*z[153] + m*z[14]*z[25]*z[46]*
  z[143] + m*z[12]*z[143]*(z[43]-ra/pow((z[39]+pow(z[31],2)+pow(z[32],2)+2*
  z[40]*z[13]+2*ra*z[32]*z[37]-2*l*z[20]*z[31]-2*ra*z[11]*z[31]-2*z[26]*z[31]*
  z[32]),0.5)) + z[335]*z[12]*z[152]*(z[44]-k/pow((z[39]+pow(z[31],2)+pow(
  z[32],2)+2*z[40]*z[13]+2*ra*z[32]*z[37]-2*l*z[20]*z[31]-2*ra*z[11]*z[31]-2*
  z[26]*z[31]*z[32]),0.5)) + m*z[11]*z[19]*z[144]*(z[44]-k/pow((z[39]+pow(
  z[31],2)+pow(z[32],2)+2*z[40]*z[13]+2*ra*z[32]*z[37]-2*l*z[20]*z[31]-2*ra*
  z[11]*z[31]-2*z[26]*z[31]*z[32]),0.5)) + m*z[12]*z[13]*z[143]*(z[44]-k/pow((
  z[39]+pow(z[31],2)+pow(z[32],2)+2*z[40]*z[13]+2*ra*z[32]*z[37]-2*l*z[20]*
  z[31]-2*ra*z[11]*z[31]-2*z[26]*z[31]*z[32]),0.5)) + m*z[12]*z[14]*z[150]*(
  z[43]-ra/pow((z[39]+pow(z[31],2)+pow(z[32],2)+2*z[40]*z[13]+2*ra*z[32]*
  z[37]-2*l*z[20]*z[31]-2*ra*z[11]*z[31]-2*z[26]*z[31]*z[32]),0.5)) + m*z[12]*
  z[14]*z[153]*(z[43]-ra/pow((z[39]+pow(z[31],2)+pow(z[32],2)+2*z[40]*z[13]+2*
  ra*z[32]*z[37]-2*l*z[20]*z[31]-2*ra*z[11]*z[31]-2*z[26]*z[31]*z[32]),0.5)) + 
  m*z[12]*z[17]*z[144]*(z[44]-k/pow((z[39]+pow(z[31],2)+pow(z[32],2)+2*z[40]*
  z[13]+2*ra*z[32]*z[37]-2*l*z[20]*z[31]-2*ra*z[11]*z[31]-2*z[26]*z[31]*z[32]),
  0.5)) + m*z[12]*z[22]*z[152]*(z[43]-ra/pow((z[39]+pow(z[31],2)+pow(z[32],2)+
  2*z[40]*z[13]+2*ra*z[32]*z[37]-2*l*z[20]*z[31]-2*ra*z[11]*z[31]-2*z[26]*
  z[31]*z[32]),0.5)) + m*z[20]*z[36]*z[46]*z[147] + m*z[20]*z[46]*(z[66]*wp+
  z[151]) + z[335]*z[20]*z[46]*(z[65]*wp+z[149]) + m*z[14]*z[25]*z[46]*(z[62]*
  wp-z[145]) + m*z[25]*z[35]*z[46]*(z[63]*wp-z[146]) + m*z[12]*z[14]*(z[44]-k/
  pow((z[39]+pow(z[31],2)+pow(z[32],2)+2*z[40]*z[13]+2*ra*z[32]*z[37]-2*l*
  z[20]*z[31]-2*ra*z[11]*z[31]-2*z[26]*z[31]*z[32]),0.5))*z[147] + m*z[12]*(
  z[43]-ra/pow((z[39]+pow(z[31],2)+pow(z[32],2)+2*z[40]*z[13]+2*ra*z[32]*
  z[37]-2*l*z[20]*z[31]-2*ra*z[11]*z[31]-2*z[26]*z[31]*z[32]),0.5))*(z[62]*wp-
  z[145]) + m*z[12]*(z[44]-k/pow((z[39]+pow(z[31],2)+pow(z[32],2)+2*z[40]*
  z[13]+2*ra*z[32]*z[37]-2*l*z[20]*z[31]-2*ra*z[11]*z[31]-2*z[26]*z[31]*z[32]),
  0.5))*(z[64]*wp-z[148]) + m*z[19]*(z[44]-k/pow((z[39]+pow(z[31],2)+pow(
  z[32],2)+2*z[40]*z[13]+2*ra*z[32]*z[37]-2*l*z[20]*z[31]-2*ra*z[11]*z[31]-2*
  z[26]*z[31]*z[32]),0.5))*(z[63]*wp-z[146]) + m*z[12]*z[13]*(z[43]-ra/pow((
  z[39]+pow(z[31],2)+pow(z[32],2)+2*z[40]*z[13]+2*ra*z[32]*z[37]-2*l*z[20]*
  z[31]-2*ra*z[11]*z[31]-2*z[26]*z[31]*z[32]),0.5))*(z[64]*wp-z[148]) + m*
  z[12]*z[13]*(z[44]-k/pow((z[39]+pow(z[31],2)+pow(z[32],2)+2*z[40]*z[13]+2*
  ra*z[32]*z[37]-2*l*z[20]*z[31]-2*ra*z[11]*z[31]-2*z[26]*z[31]*z[32]),0.5))*(
  z[62]*wp-z[145]) - m*z[18]*z[25]*z[46]*z[144] - m*z[20]*z[21]*z[46]*z[143] - 
  m*z[20]*z[23]*z[46]*z[144] - z[336]*z[19]*z[152]*(z[44]-k/pow((z[39]+pow(
  z[31],2)+pow(z[32],2)+2*z[40]*z[13]+2*ra*z[32]*z[37]-2*l*z[20]*z[31]-2*ra*
  z[11]*z[31]-2*z[26]*z[31]*z[32]),0.5)) - m*z[25]*z[38]*z[46]*z[147] - 
  z[336]*z[20]*z[46]*(z[64]*wp-z[148]) - m*z[20]*z[21]*z[46]*(z[62]*wp-z[145]) - 
  m*z[20]*z[33]*z[46]*(z[63]*wp-z[146]) - m*z[19]*(z[44]-k/pow((z[39]+pow(
  z[31],2)+pow(z[32],2)+2*z[40]*z[13]+2*ra*z[32]*z[37]-2*l*z[20]*z[31]-2*ra*
  z[11]*z[31]-2*z[26]*z[31]*z[32]),0.5))*(z[65]*wp+z[149]) - z[335]*z[19]*(
  z[44]-k/pow((z[39]+pow(z[31],2)+pow(z[32],2)+2*z[40]*z[13]+2*ra*z[32]*z[37]-
  2*l*z[20]*z[31]-2*ra*z[11]*z[31]-2*z[26]*z[31]*z[32]),0.5))*(z[66]*wp+
  z[151]) - z[336]*z[12]*(z[44]-k/pow((z[39]+pow(z[31],2)+pow(z[32],2)+2*
  z[40]*z[13]+2*ra*z[32]*z[37]-2*l*z[20]*z[31]-2*ra*z[11]*z[31]-2*z[26]*z[31]*
  z[32]),0.5))*(z[66]*wp+z[151]) - m*z[12]*z[21]*(z[43]-ra/pow((z[39]+pow(
  z[31],2)+pow(z[32],2)+2*z[40]*z[13]+2*ra*z[32]*z[37]-2*l*z[20]*z[31]-2*ra*
  z[11]*z[31]-2*z[26]*z[31]*z[32]),0.5))*(z[66]*wp+z[151]) - (Izz*pow(w,2)*
  z[25]*z[46]*(z[44]+z[13]*z[43]-z[20]*z[45])+z[19]*(Ixx*z[13]*z[108]+Ixx*
  z[17]*z[109]+Ixy*z[11]*z[109]+pow(w,2)*z[44]*(z[154]*z[46]+Ixy*z[19]*z[45]-
  z[161]*z[46]-Ixy*z[14]*z[43]-Iyy*z[12]*z[45])+Ixx*z[19]*(z[45]*wp+z[110])+
  z[155]*(z[46]*wp-z[114])-Ixx*z[13]*z[111]-z[156]*(z[46]*wp-z[114])-Ixx*
  z[14]*(z[43]*wp-z[112]))+z[20]*(Izz*z[18]*z[109]+Izz*z[14]*z[111]+Izz*z[20]*(
  z[45]*wp+z[110])-Izz*z[14]*z[108]-z[15]*pow(w,2)*z[46]*(z[155]*z[46]+Ixx*
  z[19]*z[45]-z[156]*z[46]-Ixx*z[14]*z[43]-Ixy*z[12]*z[45])-z[16]*pow(w,2)*
  z[46]*(z[154]*z[46]+Ixy*z[19]*z[45]-z[161]*z[46]-Ixy*z[14]*z[43]-Iyy*z[12]*
  z[45])-Izz*(z[44]*wp-z[113])-Izz*z[13]*(z[43]*wp-z[112]))-z[12]*(Ixy*z[13]*
  z[108]+Ixy*z[17]*z[109]+Iyy*z[11]*z[109]+z[154]*(z[46]*wp-z[114])+2*Ixy*
  z[19]*(z[45]*wp+z[110])-Izz*pow(w,2)*z[14]*z[43]*(z[44]+z[13]*z[43]-z[20]*
  z[45])-pow(w,2)*z[44]*(z[155]*z[46]+Ixx*z[19]*z[45]-z[156]*z[46]-Ixx*z[14]*
  z[43]-Ixy*z[12]*z[45])-pow(w,2)*z[13]*z[43]*(z[155]*z[46]+Ixx*z[19]*z[45]-
  z[156]*z[46]-Ixx*z[14]*z[43]-Ixy*z[12]*z[45])-Ixy*z[13]*z[111]-Iyy*z[12]*(
  z[45]*wp+z[110])-z[161]*(z[46]*wp-z[114])-Ixy*z[14]*(z[43]*wp-z[112])))/
  pow((z[39]+pow(z[31],2)+pow(z[32],2)+2*z[40]*z[13]+2*ra*z[32]*z[37]-2*l*
  z[20]*z[31]-2*ra*z[11]*z[31]-2*z[26]*z[31]*z[32]),0.5);
  z[334] = pow(z[12],2)*pow(z[43],2) + pow(z[12],2)*pow(z[44],2) + pow(z[19],
  2)*pow(z[44],2) + pow(z[20],2)*pow(z[46],2) + pow(z[25],2)*pow(z[46],2) + 2*
  z[12]*z[14]*z[25]*z[43]*z[46] + 2*z[13]*z[43]*z[44]*pow(z[12],2) - 2*z[15]*
  z[12]*z[20]*z[44]*z[46] - 2*z[16]*z[19]*z[20]*z[44]*z[46] - 2*z[12]*z[20]*
  z[21]*z[43]*z[46];
  z[349] = z[337]/z[334];
  fay = z[349];
  z[346] = m*z[26]*z[152] + m*z[11]*z[147] + m*z[12]*(z[65]*wp+z[149]) + m*
  z[25]*(z[66]*wp+z[151]) + m*z[19]*(z[64]*wp-z[148]) + (z[339]*z[44]*pow(
  z[19],2)+z[341]*z[20]*z[46]*z[152]+z[341]*z[20]*z[22]*z[46]*z[143]+z[339]*
  pow(z[12],2)*(z[44]+z[13]*z[43])+z[341]*z[11]*z[12]*z[144]*(z[44]+z[13]*
  z[43])+Izz*pow(w,2)*z[20]*pow(z[46],2)*(z[44]+z[13]*z[43]-z[20]*z[45])+
  z[344]*z[35]*z[153]*(z[12]*z[43]+z[12]*z[13]*z[44]-z[20]*z[21]*z[46])+
  z[344]*z[143]*(z[20]*z[33]*z[46]-z[19]*z[44]-z[25]*z[35]*z[46])+z[344]*
  z[14]*z[150]*(z[20]*z[33]*z[46]-z[19]*z[44]-z[25]*z[35]*z[46])+z[344]*z[22]*
  z[152]*(z[20]*z[33]*z[46]-z[19]*z[44]-z[25]*z[35]*z[46])+z[345]*z[12]*(
  z[12]*z[43]+z[12]*z[13]*z[44]+z[14]*z[25]*z[46]-z[20]*z[21]*z[46])+z[344]*
  z[11]*z[144]*(z[12]*z[43]+z[12]*z[13]*z[44]+z[14]*z[25]*z[46]-z[20]*z[21]*
  z[46])+pow(w,2)*z[14]*z[25]*z[43]*z[46]*(z[154]*z[46]+Ixy*z[19]*z[45]-Ixy*
  z[14]*z[43]-Iyy*z[12]*z[45])+pow(w,2)*z[12]*pow(z[43],2)*(z[154]*z[46]+Ixy*
  z[19]*z[45]-z[161]*z[46]-Ixy*z[14]*z[43]-Iyy*z[12]*z[45])+pow(w,2)*z[11]*
  z[20]*z[21]*z[45]*z[46]*(z[154]*z[46]+Ixy*z[19]*z[45]-z[161]*z[46]-Ixy*
  z[14]*z[43]-Iyy*z[12]*z[45])+z[341]*z[20]*z[37]*z[46]*z[147]+z[342]*z[19]*
  z[44]*(z[66]*wp+z[151])+z[342]*z[20]*z[46]*(z[65]*wp+z[149])+z[340]*z[20]*
  z[46]*(z[64]*wp-z[148])+z[341]*z[20]*z[22]*z[46]*(z[62]*wp-z[145])+z[341]*
  z[12]*(z[44]+z[13]*z[43])*(z[63]*wp-z[146])+z[344]*z[21]*(z[19]*z[44]+z[25]*
  z[35]*z[46])*(z[66]*wp+z[151])+z[344]*(z[20]*z[33]*z[46]-z[19]*z[44]-z[25]*
  z[35]*z[46])*(z[62]*wp-z[145])+z[344]*z[13]*(z[20]*z[33]*z[46]-z[19]*z[44]-
  z[25]*z[35]*z[46])*(z[64]*wp-z[148])+z[344]*(z[12]*z[43]+z[12]*z[13]*z[44]+
  z[14]*z[25]*z[46]-z[20]*z[21]*z[46])*(z[63]*wp-z[146])+z[12]*z[13]*z[43]*(
  Ixx*z[13]*z[108]+Ixx*z[17]*z[109]+Ixy*z[11]*z[109]+2*pow(w,2)*z[44]*(z[154]*
  z[46]+1.5*Ixy*z[19]*z[45])+Izz*pow(w,2)*z[12]*z[45]*(z[13]*z[43]-z[20]*
  z[45])+Ixx*z[19]*(z[45]*wp+z[110])+z[155]*(z[46]*wp-z[114])-Ixx*z[13]*
  z[111]-Ixy*z[12]*(z[45]*wp+z[110])-z[156]*(z[46]*wp-z[114])-Ixx*z[14]*(
  z[43]*wp-z[112]))+z[12]*z[44]*(Ixx*z[13]*z[108]+Ixx*z[17]*z[109]+Ixy*z[11]*
  z[109]+Izz*pow(w,2)*z[12]*z[45]*(z[44]+2*z[13]*z[43]-z[20]*z[45])+pow(w,2)*
  z[44]*(z[154]*z[46]+2*Ixy*z[19]*z[45]-z[161]*z[46]-Ixy*z[14]*z[43]-Iyy*
  z[12]*z[45])+Ixx*z[19]*(z[45]*wp+z[110])+z[155]*(z[46]*wp-z[114])-Ixx*z[13]*
  z[111]-Ixy*z[12]*(z[45]*wp+z[110])-z[156]*(z[46]*wp-z[114])-Ixx*z[14]*(
  z[43]*wp-z[112]))+z[19]*z[44]*(Ixy*z[13]*z[108]+Ixy*z[17]*z[109]+Iyy*z[11]*
  z[109]+Izz*pow(w,2)*z[19]*z[45]*(z[44]+z[13]*z[43]-z[20]*z[45])+pow(w,2)*
  z[20]*z[45]*(Ixx*z[19]*z[45]-Ixx*z[14]*z[43]-Ixy*z[12]*z[45])+pow(w,2)*
  z[44]*(z[156]*z[46]+Ixx*z[14]*z[43]-z[155]*z[46]-Ixx*z[19]*z[45])+pow(w,2)*
  z[13]*z[43]*(z[156]*z[46]+Ixx*z[14]*z[43]-z[155]*z[46]-Ixx*z[19]*z[45])+Ixy*
  z[19]*(z[45]*wp+z[110])+z[154]*(z[46]*wp-z[114])-Izz*pow(w,2)*z[14]*z[43]*(
  z[44]+z[13]*z[43]-z[20]*z[45])-Ixy*z[13]*z[111]-Iyy*z[12]*(z[45]*wp+z[110])-
  z[161]*(z[46]*wp-z[114])-Ixy*z[14]*(z[43]*wp-z[112]))-z[339]*z[20]*z[26]*
  z[46]-z[340]*z[19]*z[44]*z[152]-z[341]*z[13]*z[19]*z[44]*z[143]-z[341]*
  z[17]*z[19]*z[44]*z[144]-z[341]*z[20]*z[24]*z[46]*z[144]-z[342]*z[12]*
  z[152]*(z[44]+z[13]*z[43])-z[312]*pow(w,2)*z[12]*z[44]*z[46]*(z[44]+z[13]*
  z[43])-z[343]*pow(w,2)*z[19]*z[44]*z[46]*(z[44]+z[13]*z[43])-z[344]*z[14]*
  z[153]*(z[19]*z[44]-z[20]*z[33]*z[46])-Izz*pow(w,2)*z[12]*z[21]*z[43]*z[46]*(
  z[44]+z[13]*z[43]-z[20]*z[45])-2*pow(w,2)*z[12]*z[13]*z[43]*z[44]*(z[161]*
  z[46]+Ixy*z[14]*z[43]+Iyy*z[12]*z[45])-z[344]*z[34]*z[152]*(z[12]*z[43]+
  z[12]*z[13]*z[44]+z[14]*z[25]*z[46]-z[20]*z[21]*z[46])-pow(w,2)*z[11]*z[12]*
  z[43]*z[45]*(z[154]*z[46]+Ixy*z[19]*z[45]-z[161]*z[46]-Ixy*z[14]*z[43]-Iyy*
  z[12]*z[45])-pow(w,2)*z[20]*z[21]*z[43]*z[46]*(z[154]*z[46]+Ixy*z[19]*z[45]-
  z[161]*z[46]-Ixy*z[14]*z[43]-Iyy*z[12]*z[45])-pow(w,2)*z[11]*z[12]*z[13]*
  z[44]*z[45]*(z[154]*z[46]+Ixy*z[19]*z[45]-z[161]*z[46]-Ixy*z[14]*z[43]-Iyy*
  z[12]*z[45])-pow(w,2)*z[11]*z[14]*z[25]*z[45]*z[46]*(z[154]*z[46]+Ixy*z[19]*
  z[45]-z[161]*z[46]-Ixy*z[14]*z[43]-Iyy*z[12]*z[45])-z[341]*z[14]*z[19]*
  z[44]*z[147]-z[341]*z[19]*z[44]*(z[64]*wp-z[148])-z[341]*z[13]*z[19]*z[44]*(
  z[62]*wp-z[145])-z[341]*z[20]*z[34]*z[46]*(z[63]*wp-z[146])-z[340]*z[12]*(
  z[44]+z[13]*z[43])*(z[66]*wp+z[151])-z[341]*z[12]*(z[44]+z[13]*z[43])*(
  z[65]*wp+z[149])-z[344]*z[33]*(z[12]*z[43]+z[12]*z[13]*z[44]+z[14]*z[25]*
  z[46])*(z[66]*wp+z[151])-z[344]*(z[12]*z[43]+z[12]*z[13]*z[44]+z[14]*z[25]*
  z[46]-z[20]*z[21]*z[46])*(z[65]*wp+z[149])-z[15]*z[20]*z[46]*(Ixx*z[13]*
  z[108]+Ixx*z[17]*z[109]+Ixy*z[11]*z[109]+Izz*pow(w,2)*z[12]*z[45]*(z[13]*
  z[43]-z[20]*z[45])+pow(w,2)*z[44]*(z[154]*z[46]-2*z[161]*z[46]-Ixy*z[14]*
  z[43]-Iyy*z[12]*z[45])+Ixx*z[19]*(z[45]*wp+z[110])+z[155]*(z[46]*wp-z[114])-
  Ixx*z[13]*z[111]-Ixy*z[12]*(z[45]*wp+z[110])-z[156]*(z[46]*wp-z[114])-Ixx*
  z[14]*(z[43]*wp-z[112]))-z[25]*z[46]*(Izz*z[18]*z[109]+pow(w,2)*z[12]*z[45]*(
  Ixx*z[19]*z[45]-z[156]*z[46]-Ixx*z[14]*z[43]-Ixy*z[12]*z[45])+Izz*z[14]*
  z[111]+Izz*z[20]*(z[45]*wp+z[110])-Izz*z[14]*z[108]-z[15]*pow(w,2)*z[46]*(
  z[155]*z[46]+Ixx*z[19]*z[45]-z[156]*z[46]-2*Ixy*z[12]*z[45]-Ixx*z[14]*z[43])-
  z[16]*pow(w,2)*z[46]*(z[154]*z[46]+Ixy*z[19]*z[45]-z[161]*z[46]-2*Ixy*z[14]*
  z[43]-Iyy*z[12]*z[45])-Izz*(z[44]*wp-z[113])-Izz*z[13]*(z[43]*wp-z[112]))-
  z[12]*z[14]*z[43]*(Izz*z[18]*z[109]+pow(w,2)*z[12]*z[45]*(Ixx*z[19]*z[45]-
  z[156]*z[46]-Ixx*z[14]*z[43]-Ixy*z[12]*z[45])+Izz*z[14]*z[111]+Izz*z[20]*(
  z[45]*wp+z[110])-Izz*z[14]*z[108]-z[15]*pow(w,2)*z[46]*(z[155]*z[46]+Ixx*
  z[19]*z[45]-z[156]*z[46]-2*Ixy*z[12]*z[45]-Ixx*z[14]*z[43])-z[16]*pow(w,2)*
  z[46]*(z[154]*z[46]+Ixy*z[19]*z[45]-z[161]*z[46]-Ixy*z[14]*z[43]-Iyy*z[12]*
  z[45])-Izz*(z[44]*wp-z[113])-Izz*z[13]*(z[43]*wp-z[112]))-z[16]*z[20]*z[46]*(
  Ixy*z[13]*z[108]+Ixy*z[17]*z[109]+Iyy*z[11]*z[109]+Izz*pow(w,2)*z[19]*z[45]*(
  z[13]*z[43]-z[20]*z[45])+pow(w,2)*z[44]*(z[156]*z[46]+Ixx*z[14]*z[43]+Ixy*
  z[12]*z[45])+pow(w,2)*z[20]*z[45]*(z[155]*z[46]+Ixx*z[19]*z[45]-z[156]*
  z[46]-Ixx*z[14]*z[43]-Ixy*z[12]*z[45])+Ixy*z[19]*(z[45]*wp+z[110])+z[154]*(
  z[46]*wp-z[114])-Izz*pow(w,2)*z[14]*z[43]*(z[44]+z[13]*z[43]-z[20]*z[45])-
  pow(w,2)*z[13]*z[43]*(z[155]*z[46]+Ixx*z[19]*z[45]-z[156]*z[46]-Ixx*z[14]*
  z[43]-Ixy*z[12]*z[45])-Ixy*z[13]*z[111]-Iyy*z[12]*(z[45]*wp+z[110])-z[161]*(
  z[46]*wp-z[114])-Ixy*z[14]*(z[43]*wp-z[112])))/pow((z[39]+pow(z[31],2)+pow(
  z[32],2)+2*z[40]*z[13]+2*ra*z[32]*z[37]-2*l*z[20]*z[31]-2*ra*z[11]*z[31]-2*
  z[26]*z[31]*z[32]),0.5) - z[338] - m*z[20]*z[150] - m*z[20]*z[153] - m*
  z[12]*(z[63]*wp-z[146]);
  faz = z[346];
  z[347] = (z[340]*z[12]*z[152]+z[344]*z[12]*z[143]+z[341]*z[11]*z[19]*z[144]+
  z[341]*z[12]*z[13]*z[143]+z[341]*z[12]*z[17]*z[144]+z[344]*z[12]*z[14]*
  z[150]+z[344]*z[12]*z[14]*z[153]+z[344]*z[12]*z[22]*z[152]+Izz*pow(w,2)*
  z[25]*z[46]*(z[44]+z[13]*z[43]-z[20]*z[45])+z[341]*z[12]*z[14]*z[147]+
  z[341]*z[12]*(z[64]*wp-z[148])+z[341]*z[19]*(z[63]*wp-z[146])+z[344]*z[12]*(
  z[62]*wp-z[145])+z[341]*z[12]*z[13]*(z[62]*wp-z[145])+z[344]*z[12]*z[13]*(
  z[64]*wp-z[148])+z[19]*(Ixx*z[13]*z[108]+Ixx*z[17]*z[109]+Ixy*z[11]*z[109]+
  pow(w,2)*z[44]*(z[154]*z[46]+Ixy*z[19]*z[45]-z[161]*z[46]-Ixy*z[14]*z[43]-
  Iyy*z[12]*z[45])+Ixx*z[19]*(z[45]*wp+z[110])+z[155]*(z[46]*wp-z[114])-Ixx*
  z[13]*z[111]-2*Ixy*z[12]*(z[45]*wp+z[110])-z[156]*(z[46]*wp-z[114])-Ixx*
  z[14]*(z[43]*wp-z[112]))+z[20]*(Izz*z[18]*z[109]+Izz*z[14]*z[111]+Izz*z[20]*(
  z[45]*wp+z[110])-Izz*z[14]*z[108]-z[15]*pow(w,2)*z[46]*(z[155]*z[46]+Ixx*
  z[19]*z[45]-z[156]*z[46]-Ixx*z[14]*z[43]-Ixy*z[12]*z[45])-z[16]*pow(w,2)*
  z[46]*(z[154]*z[46]+Ixy*z[19]*z[45]-z[161]*z[46]-Ixy*z[14]*z[43]-Iyy*z[12]*
  z[45])-Izz*(z[44]*wp-z[113])-Izz*z[13]*(z[43]*wp-z[112]))-z[342]*z[19]*
  z[152]-z[340]*z[19]*(z[66]*wp+z[151])-z[341]*z[19]*(z[65]*wp+z[149])-z[342]*
  z[12]*(z[66]*wp+z[151])-z[344]*z[12]*z[21]*(z[66]*wp+z[151])-z[12]*(Ixy*
  z[13]*z[108]+Ixy*z[17]*z[109]+Iyy*z[11]*z[109]+z[154]*(z[46]*wp-z[114])-Izz*
  pow(w,2)*z[14]*z[43]*(z[44]+z[13]*z[43]-z[20]*z[45])-pow(w,2)*z[44]*(z[155]*
  z[46]+Ixx*z[19]*z[45]-z[156]*z[46]-Ixx*z[14]*z[43]-Ixy*z[12]*z[45])-pow(w,2)*
  z[13]*z[43]*(z[155]*z[46]+Ixx*z[19]*z[45]-z[156]*z[46]-Ixx*z[14]*z[43]-Ixy*
  z[12]*z[45])-Ixy*z[13]*z[111]-Iyy*z[12]*(z[45]*wp+z[110])-z[161]*(z[46]*wp-
  z[114])-Ixy*z[14]*(z[43]*wp-z[112])))/pow((z[39]+pow(z[31],2)+pow(z[32],2)+
  2*z[40]*z[13]+2*ra*z[32]*z[37]-2*l*z[20]*z[31]-2*ra*z[11]*z[31]-2*z[26]*
  z[31]*z[32]),0.5);
  z[350] = z[347]/z[334];
  fby = z[350];
  z[348] = (z[339]*z[44]*pow(z[19],2)+z[341]*z[20]*z[46]*z[152]+z[341]*z[20]*
  z[22]*z[46]*z[143]+z[339]*pow(z[12],2)*(z[44]+z[13]*z[43])+z[341]*z[11]*
  z[12]*z[144]*(z[44]+z[13]*z[43])+Izz*pow(w,2)*z[20]*pow(z[46],2)*(z[44]+
  z[13]*z[43]-z[20]*z[45])+z[344]*z[35]*z[153]*(z[12]*z[43]+z[12]*z[13]*z[44]-
  z[20]*z[21]*z[46])+z[344]*z[143]*(z[20]*z[33]*z[46]-z[19]*z[44]-z[25]*z[35]*
  z[46])+z[344]*z[14]*z[150]*(z[20]*z[33]*z[46]-z[19]*z[44]-z[25]*z[35]*z[46])+
  z[344]*z[22]*z[152]*(z[20]*z[33]*z[46]-z[19]*z[44]-z[25]*z[35]*z[46])+
  z[345]*z[12]*(z[12]*z[43]+z[12]*z[13]*z[44]+z[14]*z[25]*z[46]-z[20]*z[21]*
  z[46])+z[344]*z[11]*z[144]*(z[12]*z[43]+z[12]*z[13]*z[44]+z[14]*z[25]*z[46]-
  z[20]*z[21]*z[46])+pow(w,2)*z[14]*z[25]*z[43]*z[46]*(z[154]*z[46]+Ixy*z[19]*
  z[45]-Ixy*z[14]*z[43]-Iyy*z[12]*z[45])+pow(w,2)*z[12]*pow(z[43],2)*(z[154]*
  z[46]+Ixy*z[19]*z[45]-z[161]*z[46]-Ixy*z[14]*z[43]-Iyy*z[12]*z[45])+pow(w,2)*
  z[11]*z[20]*z[21]*z[45]*z[46]*(z[154]*z[46]+Ixy*z[19]*z[45]-z[161]*z[46]-
  Ixy*z[14]*z[43]-Iyy*z[12]*z[45])+z[341]*z[20]*z[37]*z[46]*z[147]+z[342]*
  z[19]*z[44]*(z[66]*wp+z[151])+z[342]*z[20]*z[46]*(z[65]*wp+z[149])+z[340]*
  z[20]*z[46]*(z[64]*wp-z[148])+z[341]*z[20]*z[22]*z[46]*(z[62]*wp-z[145])+
  z[341]*z[12]*(z[44]+z[13]*z[43])*(z[63]*wp-z[146])+z[344]*z[21]*(z[19]*
  z[44]+z[25]*z[35]*z[46])*(z[66]*wp+z[151])+z[344]*(z[20]*z[33]*z[46]-z[19]*
  z[44]-z[25]*z[35]*z[46])*(z[62]*wp-z[145])+z[344]*z[13]*(z[20]*z[33]*z[46]-
  z[19]*z[44]-z[25]*z[35]*z[46])*(z[64]*wp-z[148])+z[344]*(z[12]*z[43]+z[12]*
  z[13]*z[44]+z[14]*z[25]*z[46]-z[20]*z[21]*z[46])*(z[63]*wp-z[146])+z[12]*
  z[13]*z[43]*(Ixx*z[13]*z[108]+Ixx*z[17]*z[109]+Ixy*z[11]*z[109]+2*pow(w,2)*
  z[44]*(z[154]*z[46]+1.5*Ixy*z[19]*z[45])+Izz*pow(w,2)*z[12]*z[45]*(z[13]*
  z[43]-z[20]*z[45])+Ixx*z[19]*(z[45]*wp+z[110])+z[155]*(z[46]*wp-z[114])-Ixx*
  z[13]*z[111]-Ixy*z[12]*(z[45]*wp+z[110])-z[156]*(z[46]*wp-z[114])-Ixx*z[14]*(
  z[43]*wp-z[112]))+z[12]*z[44]*(Ixx*z[13]*z[108]+Ixx*z[17]*z[109]+Ixy*z[11]*
  z[109]+Izz*pow(w,2)*z[12]*z[45]*(z[44]+2*z[13]*z[43]-z[20]*z[45])+pow(w,2)*
  z[44]*(z[154]*z[46]+2*Ixy*z[19]*z[45]-z[161]*z[46]-Ixy*z[14]*z[43]-Iyy*
  z[12]*z[45])+Ixx*z[19]*(z[45]*wp+z[110])+z[155]*(z[46]*wp-z[114])-Ixx*z[13]*
  z[111]-Ixy*z[12]*(z[45]*wp+z[110])-z[156]*(z[46]*wp-z[114])-Ixx*z[14]*(
  z[43]*wp-z[112]))+z[19]*z[44]*(Ixy*z[13]*z[108]+Ixy*z[17]*z[109]+Iyy*z[11]*
  z[109]+Izz*pow(w,2)*z[19]*z[45]*(z[44]+z[13]*z[43]-z[20]*z[45])+pow(w,2)*
  z[20]*z[45]*(Ixx*z[19]*z[45]-Ixx*z[14]*z[43]-Ixy*z[12]*z[45])+pow(w,2)*
  z[44]*(z[156]*z[46]+Ixx*z[14]*z[43]-z[155]*z[46]-Ixx*z[19]*z[45])+pow(w,2)*
  z[13]*z[43]*(z[156]*z[46]+Ixx*z[14]*z[43]-z[155]*z[46]-Ixx*z[19]*z[45])+Ixy*
  z[19]*(z[45]*wp+z[110])+z[154]*(z[46]*wp-z[114])-Izz*pow(w,2)*z[14]*z[43]*(
  z[44]+z[13]*z[43]-z[20]*z[45])-Ixy*z[13]*z[111]-Iyy*z[12]*(z[45]*wp+z[110])-
  z[161]*(z[46]*wp-z[114])-Ixy*z[14]*(z[43]*wp-z[112]))-z[339]*z[20]*z[26]*
  z[46]-z[340]*z[19]*z[44]*z[152]-z[341]*z[13]*z[19]*z[44]*z[143]-z[341]*
  z[17]*z[19]*z[44]*z[144]-z[341]*z[20]*z[24]*z[46]*z[144]-z[342]*z[12]*
  z[152]*(z[44]+z[13]*z[43])-z[312]*pow(w,2)*z[12]*z[44]*z[46]*(z[44]+z[13]*
  z[43])-z[343]*pow(w,2)*z[19]*z[44]*z[46]*(z[44]+z[13]*z[43])-z[344]*z[14]*
  z[153]*(z[19]*z[44]-z[20]*z[33]*z[46])-Izz*pow(w,2)*z[12]*z[21]*z[43]*z[46]*(
  z[44]+z[13]*z[43]-z[20]*z[45])-2*pow(w,2)*z[12]*z[13]*z[43]*z[44]*(z[161]*
  z[46]+Ixy*z[14]*z[43]+Iyy*z[12]*z[45])-z[344]*z[34]*z[152]*(z[12]*z[43]+
  z[12]*z[13]*z[44]+z[14]*z[25]*z[46]-z[20]*z[21]*z[46])-pow(w,2)*z[11]*z[12]*
  z[43]*z[45]*(z[154]*z[46]+Ixy*z[19]*z[45]-z[161]*z[46]-Ixy*z[14]*z[43]-Iyy*
  z[12]*z[45])-pow(w,2)*z[20]*z[21]*z[43]*z[46]*(z[154]*z[46]+Ixy*z[19]*z[45]-
  z[161]*z[46]-Ixy*z[14]*z[43]-Iyy*z[12]*z[45])-pow(w,2)*z[11]*z[12]*z[13]*
  z[44]*z[45]*(z[154]*z[46]+Ixy*z[19]*z[45]-z[161]*z[46]-Ixy*z[14]*z[43]-Iyy*
  z[12]*z[45])-pow(w,2)*z[11]*z[14]*z[25]*z[45]*z[46]*(z[154]*z[46]+Ixy*z[19]*
  z[45]-z[161]*z[46]-Ixy*z[14]*z[43]-Iyy*z[12]*z[45])-z[341]*z[14]*z[19]*
  z[44]*z[147]-z[341]*z[19]*z[44]*(z[64]*wp-z[148])-z[341]*z[13]*z[19]*z[44]*(
  z[62]*wp-z[145])-z[341]*z[20]*z[34]*z[46]*(z[63]*wp-z[146])-z[340]*z[12]*(
  z[44]+z[13]*z[43])*(z[66]*wp+z[151])-z[341]*z[12]*(z[44]+z[13]*z[43])*(
  z[65]*wp+z[149])-z[344]*z[33]*(z[12]*z[43]+z[12]*z[13]*z[44]+z[14]*z[25]*
  z[46])*(z[66]*wp+z[151])-z[344]*(z[12]*z[43]+z[12]*z[13]*z[44]+z[14]*z[25]*
  z[46]-z[20]*z[21]*z[46])*(z[65]*wp+z[149])-z[15]*z[20]*z[46]*(Ixx*z[13]*
  z[108]+Ixx*z[17]*z[109]+Ixy*z[11]*z[109]+Izz*pow(w,2)*z[12]*z[45]*(z[13]*
  z[43]-z[20]*z[45])+pow(w,2)*z[44]*(z[154]*z[46]-2*z[161]*z[46]-Ixy*z[14]*
  z[43]-Iyy*z[12]*z[45])+Ixx*z[19]*(z[45]*wp+z[110])+z[155]*(z[46]*wp-z[114])-
  Ixx*z[13]*z[111]-Ixy*z[12]*(z[45]*wp+z[110])-z[156]*(z[46]*wp-z[114])-Ixx*
  z[14]*(z[43]*wp-z[112]))-z[25]*z[46]*(Izz*z[18]*z[109]+pow(w,2)*z[12]*z[45]*(
  Ixx*z[19]*z[45]-z[156]*z[46]-Ixx*z[14]*z[43]-Ixy*z[12]*z[45])+Izz*z[14]*
  z[111]+Izz*z[20]*(z[45]*wp+z[110])-Izz*z[14]*z[108]-z[15]*pow(w,2)*z[46]*(
  z[155]*z[46]+Ixx*z[19]*z[45]-z[156]*z[46]-2*Ixy*z[12]*z[45]-Ixx*z[14]*z[43])-
  z[16]*pow(w,2)*z[46]*(z[154]*z[46]+Ixy*z[19]*z[45]-z[161]*z[46]-2*Ixy*z[14]*
  z[43]-Iyy*z[12]*z[45])-Izz*(z[44]*wp-z[113])-Izz*z[13]*(z[43]*wp-z[112]))-
  z[12]*z[14]*z[43]*(Izz*z[18]*z[109]+pow(w,2)*z[12]*z[45]*(Ixx*z[19]*z[45]-
  z[156]*z[46]-Ixx*z[14]*z[43]-Ixy*z[12]*z[45])+Izz*z[14]*z[111]+Izz*z[20]*(
  z[45]*wp+z[110])-Izz*z[14]*z[108]-z[15]*pow(w,2)*z[46]*(z[155]*z[46]+Ixx*
  z[19]*z[45]-z[156]*z[46]-2*Ixy*z[12]*z[45]-Ixx*z[14]*z[43])-z[16]*pow(w,2)*
  z[46]*(z[154]*z[46]+Ixy*z[19]*z[45]-z[161]*z[46]-Ixy*z[14]*z[43]-Iyy*z[12]*
  z[45])-Izz*(z[44]*wp-z[113])-Izz*z[13]*(z[43]*wp-z[112]))-z[16]*z[20]*z[46]*(
  Ixy*z[13]*z[108]+Ixy*z[17]*z[109]+Iyy*z[11]*z[109]+Izz*pow(w,2)*z[19]*z[45]*(
  z[13]*z[43]-z[20]*z[45])+pow(w,2)*z[44]*(z[156]*z[46]+Ixx*z[14]*z[43]+Ixy*
  z[12]*z[45])+pow(w,2)*z[20]*z[45]*(z[155]*z[46]+Ixx*z[19]*z[45]-z[156]*
  z[46]-Ixx*z[14]*z[43]-Ixy*z[12]*z[45])+Ixy*z[19]*(z[45]*wp+z[110])+z[154]*(
  z[46]*wp-z[114])-Izz*pow(w,2)*z[14]*z[43]*(z[44]+z[13]*z[43]-z[20]*z[45])-
  pow(w,2)*z[13]*z[43]*(z[155]*z[46]+Ixx*z[19]*z[45]-z[156]*z[46]-Ixx*z[14]*
  z[43]-Ixy*z[12]*z[45])-Ixy*z[13]*z[111]-Iyy*z[12]*(z[45]*wp+z[110])-z[161]*(
  z[46]*wp-z[114])-Ixy*z[14]*(z[43]*wp-z[112])))/pow((z[39]+pow(z[31],2)+pow(
  z[32],2)+2*z[40]*z[13]+2*ra*z[32]*z[37]-2*l*z[20]*z[31]-2*ra*z[11]*z[31]-2*
  z[26]*z[31]*z[32]),0.5);
  fbz = -z[348];
  z[47] = pow(z[31],2) + pow(z[32],2) - 2*z[26]*z[31]*z[32];
  z[48] = pow(z[47],0.5);
  z[50] = z[32]/z[48];
  z[58] = z[10]*z[11];
  z[59] = z[9]*z[11];
  z[60] = z[10]*z[12];
  z[61] = z[9]*z[12];
  z[165] = z[15]*z[11] - z[16]*z[12]*z[14];
  z[166] = z[165]*(z[28]+pow(z[26],2)/pow(z[27],0.5))/pow(z[28],2);
  z[167] = z[26]*z[165]/(pow(z[27],0.5)*pow(z[28],2));
  z[168] = -z[15]*z[12] - z[16]*z[11]*z[14];
  z[169] = z[11]*z[165] - z[11]*z[24] - z[12]*z[26] - z[12]*z[168];
  z[172] = 2*ra*z[12]*z[31] + 2*ra*z[32]*z[169] + 2*rb*z[31]*z[167] + 2*rb*
  z[32]*z[166] + 2*z[170]*z[37]*z[166] + 2*l*z[12]*z[13]*z[31] - 2*z[170]*
  z[11]*z[167] - 2*z[171]*z[20]*z[167] - 2*z[31]*z[32]*z[165] - 2*rb*z[26]*
  z[31]*z[166] - 2*rb*z[26]*z[32]*z[167];
  z[173] = (2*rb*z[42]*z[166]-z[32]*z[172]/pow(z[41],0.5))/pow(z[42],2);
  z[174] = ra*z[172]/(pow(z[41],0.5)*pow(z[42],2));
  z[175] = (2*rb*z[42]*z[167]-z[31]*z[172]/pow(z[41],0.5))/pow(z[42],2);
  z[176] = 0.5*z[16]*z[173] + z[12]*z[14]*z[45] - 0.5*z[14]*z[174] - 0.5*
  z[19]*z[175];
  z[177] = l*z[172]/(pow(z[41],0.5)*pow(z[42],2));
  z[178] = 0.5*z[177] + 0.5*z[13]*z[174] + 0.5*z[20]*z[175] - z[12]*z[13]*
  z[45];
  z[179] = z[13]*z[176] + z[14]*z[178];
  z[180] = z[16]*z[11]*z[13]*z[26];
  z[181] = (z[16]*z[11]*z[13]*z[28]+z[26]*z[180]/pow(z[27],0.5))/pow(z[28],2);
  z[182] = rb*z[180]/(pow(z[27],0.5)*pow(z[28],2));
  z[183] = z[16]*z[13]*(pow(z[11],2)+pow(z[12],2));
  z[184] = 2*z[31]*z[182] + 2*ra*z[32]*z[183] + 2*rb*z[32]*z[181] + 2*z[170]*
  z[37]*z[181] + 2*l*z[11]*z[14]*z[31] - 2*z[40]*z[14] - 2*l*z[20]*z[182] - 2*
  ra*z[11]*z[182] - 2*z[26]*z[32]*z[182] - 2*rb*z[26]*z[31]*z[181] - 2*z[16]*
  z[11]*z[13]*z[31]*z[32];
  z[185] = (2*rb*z[42]*z[181]-z[32]*z[184]/pow(z[41],0.5))/pow(z[42],2);
  z[186] = ra*z[184]/(pow(z[41],0.5)*pow(z[42],2));
  z[187] = (2*z[42]*z[182]-z[31]*z[184]/pow(z[41],0.5))/pow(z[42],2);
  z[188] = z[13]*z[43] + 0.5*z[16]*z[185] - 0.5*z[14]*z[186] - 0.5*z[19]*
  z[187] - z[11]*z[13]*z[45];
  z[189] = l*z[184]/(pow(z[41],0.5)*pow(z[42],2));
  z[190] = 0.5*z[189] + z[14]*z[43] + 0.5*z[13]*z[186] + 0.5*z[20]*z[187] - 
  z[11]*z[14]*z[45];
  z[191] = z[13]*z[52] + z[13]*z[188] + z[14]*z[190] - z[14]*z[51];
  z[192] = z[11]*z[45] + 0.5*z[12]*z[175] - 0.5*z[15]*z[173];
  z[193] = z[192] - z[56]*(z[13]*z[178]-z[14]*z[176]) - (z[13]*z[52]-z[14]*
  z[51])/pow(z[11],2);
  z[194] = 0.5*z[12]*z[187] - 0.5*z[15]*z[185];
  z[195] = z[194] - z[56]*(z[13]*z[190]-z[13]*z[51]-z[14]*z[52]-z[14]*z[188]);
  z[196] = z[16]*z[11] + z[15]*z[12]*z[14];
  z[197] = m*(k*z[25]*z[173]+2*k*z[46]*z[196]+2*k*z[11]*z[14]*z[43]+ra*z[12]*(
  z[14]*z[177]+z[22]*z[173])-k*z[12]*z[14]*z[174]-2*ra*z[11]*(z[14]*z[44]-
  z[22]*z[46]));
  z[198] = z[15]*z[11]*z[14] - z[16]*z[12];
  z[199] = z[11]*z[196] - z[11]*z[23] - z[12]*z[25] - z[12]*z[198];
  z[200] = 0.5*w*z[175]*(z[12]*z[68]+z[18]*z[69]-z[24]*z[70]) - 0.5*z[67]*(2*
  z[70]*z[168]+w*z[12]*z[174]+w*z[18]*z[177]+w*z[24]*z[173]-2*z[11]*z[68]-2*
  z[11]*z[13]*z[69]);
  z[201] = w*(z[67]*(z[14]*z[177]+z[22]*z[173])-z[175]*(z[14]*z[69]-z[22]*
  z[70]));
  z[202] = z[24]*z[165] + z[26]*z[168];
  z[203] = (z[27]*z[202]+z[26]*z[72]*z[165])/pow(z[27],1.5);
  z[204] = (z[28]*z[203]+2*z[26]*z[74]*z[165]/pow(z[27],0.5))/pow(z[28],3);
  z[205] = (z[28]*(z[26]*z[203]+z[28]*z[168]+z[74]*z[165])+z[26]*z[165]*(
  z[24]*z[28]+2*z[26]*z[74])/pow(z[27],0.5))/pow(z[28],3);
  z[206] = z[16]*z[12]*z[14] - z[15]*z[11];
  z[207] = z[11]*(z[26]+z[84]) + z[12]*(z[165]+z[206]);
  z[208] = 2*ra*z[11]*z[31] + 2*ra*z[12]*z[78] + 2*ra*z[82]*z[169] + 2*rb*
  z[31]*z[204] + 2*rb*z[32]*z[205] + 2*rb*z[78]*z[167] + 2*rb*z[82]*z[166] + 
  2*z[170]*z[12]*z[167] + 2*z[170]*z[37]*z[205] + 2*z[171]*z[18]*z[167] + 2*l*
  z[11]*z[13]*z[31] + 2*l*z[12]*z[13]*z[78] - 2*ra*z[32]*z[207] - 2*z[170]*
  z[11]*z[204] - 2*z[170]*z[86]*z[166] - 2*z[171]*z[20]*z[204] - 2*z[31]*
  z[32]*z[168] - 2*z[31]*z[82]*z[165] - 2*z[32]*z[78]*z[165] - 2*rb*z[24]*
  z[31]*z[166] - 2*rb*z[24]*z[32]*z[167] - 2*rb*z[26]*z[31]*z[205] - 2*rb*
  z[26]*z[32]*z[204] - 2*rb*z[26]*z[78]*z[166] - 2*rb*z[26]*z[82]*z[167];
  z[209] = (2*z[41]*z[208]-z[88]*z[172])/pow(z[41],1.5);
  z[210] = (2*z[32]*z[90]*z[172]/pow(z[41],0.5)+z[42]*(4*rb*z[42]*z[205]-
  z[32]*z[209]-2*rb*z[90]*z[166]-2*z[82]*z[172]/pow(z[41],0.5)))/pow(z[42],3);
  z[211] = z[71]*z[165] - z[16]*z[12]*z[13]*z[26];
  z[212] = (z[27]*z[211]+z[26]*z[73]*z[165])/pow(z[27],1.5);
  z[213] = (z[28]*z[212]+2*z[26]*z[75]*z[165]/pow(z[27],0.5))/pow(z[28],3);
  z[214] = (z[26]*z[165]*(z[28]*z[71]+2*z[26]*z[75])/pow(z[27],0.5)+z[28]*(
  z[26]*z[212]+z[75]*z[165]-z[16]*z[12]*z[13]*z[28]))/pow(z[28],3);
  z[215] = z[11]*z[85] - z[12]*z[71];
  z[216] = 2*ra*z[12]*z[79] + 2*ra*z[32]*z[215] + 2*ra*z[83]*z[169] + 2*rb*
  z[31]*z[213] + 2*rb*z[32]*z[214] + 2*rb*z[79]*z[167] + 2*rb*z[83]*z[166] + 
  2*z[170]*z[37]*z[214] + 2*z[170]*z[87]*z[166] + 2*z[171]*z[19]*z[167] + 2*l*
  z[12]*z[13]*z[79] + 2*z[16]*z[12]*z[13]*z[31]*z[32] - 2*z[170]*z[11]*z[213] - 
  2*z[171]*z[20]*z[213] - 2*z[31]*z[83]*z[165] - 2*z[32]*z[79]*z[165] - 2*l*
  z[12]*z[14]*z[31] - 2*rb*z[26]*z[31]*z[214] - 2*rb*z[26]*z[32]*z[213] - 2*
  rb*z[26]*z[79]*z[166] - 2*rb*z[26]*z[83]*z[167] - 2*rb*z[31]*z[71]*z[166] - 
  2*rb*z[32]*z[71]*z[167];
  z[217] = (2*z[41]*z[216]-z[89]*z[172])/pow(z[41],1.5);
  z[218] = (2*z[32]*z[91]*z[172]/pow(z[41],0.5)+z[42]*(4*rb*z[42]*z[214]-
  z[32]*z[217]-2*rb*z[91]*z[166]-2*z[83]*z[172]/pow(z[41],0.5)))/pow(z[42],3);
  z[219] = w*(2*z[106]*z[179]+2*z[107]*z[193]-z[210]*q2p-z[218]*q3p);
  z[220] = ra*(z[42]*z[209]-2*z[90]*z[172]/pow(z[41],0.5))/pow(z[42],3);
  z[221] = ra*(z[42]*z[217]-2*z[91]*z[172]/pow(z[41],0.5))/pow(z[42],3);
  z[222] = w*(2*z[98]*z[179]+2*z[99]*z[193]+z[220]*q2p+z[221]*q3p);
  z[223] = w*(2*z[68]*z[193]-z[174]*q3p);
  z[224] = (2*z[31]*z[90]*z[172]/pow(z[41],0.5)+z[42]*(4*rb*z[42]*z[204]-
  z[31]*z[209]-2*rb*z[90]*z[167]-2*z[78]*z[172]/pow(z[41],0.5)))/pow(z[42],3);
  z[225] = (2*z[31]*z[91]*z[172]/pow(z[41],0.5)+z[42]*(4*rb*z[42]*z[213]-
  z[31]*z[217]-2*rb*z[91]*z[167]-2*z[79]*z[172]/pow(z[41],0.5)))/pow(z[42],3);
  z[226] = w*(2*z[94]*z[179]+2*z[95]*z[193]-z[224]*q2p-z[225]*q3p);
  z[227] = l*(z[42]*z[209]-2*z[90]*z[172]/pow(z[41],0.5))/pow(z[42],3);
  z[228] = l*(z[42]*z[217]-2*z[91]*z[172]/pow(z[41],0.5))/pow(z[42],3);
  z[229] = w*(2*z[102]*z[179]+2*z[103]*z[193]+z[227]*q2p+z[228]*q3p);
  z[230] = z[11]*z[18] - z[12]*z[20];
  z[231] = pow(w,2)*(k*z[173]*(z[20]*z[45]-z[44]-z[38]*z[43])+z[66]*(z[177]+
  z[20]*z[175]+z[38]*z[174]-2*z[43]*z[230]-2*z[12]*z[13]*z[45]));
  z[232] = k*(z[14]*z[174]+z[19]*z[175]-2*z[12]*z[14]*z[45]);
  z[233] = pow(w,2)*(z[11]*z[65]*z[175]-2*z[12]*z[45]*z[65]-z[11]*z[45]*
  z[232]);
  z[234] = z[11]*z[26] + z[11]*z[168] + z[12]*z[165] - z[12]*z[24];
  z[235] = ra*(z[12]*z[175]+2*z[11]*z[45]-2*z[46]*z[234]-z[34]*z[173]);
  z[236] = pow(w,2)*(z[45]*z[235]+z[62]*z[175]);
  z[237] = k*(z[12]*z[175]+2*z[11]*z[45]);
  z[238] = pow(w,2)*(z[15]*z[46]*z[237]+z[15]*z[64]*z[173]+z[16]*z[46]*z[232]-
  2*z[11]*z[45]*z[64]-z[16]*z[65]*z[173]-z[12]*z[45]*z[237]-z[12]*z[64]*
  z[175]);
  z[239] = pow(w,2)*(k*z[173]*(z[26]*z[45]-z[46]-z[37]*z[43])-z[66]*(z[173]+2*
  z[43]*z[169]-2*z[45]*z[165]-z[26]*z[175]-z[37]*z[174]));
  z[240] = z[11]*z[20] + z[12]*z[18] - z[13]*pow(z[11],2) - z[13]*pow(z[12],2);
  z[241] = w*(2*z[141]*z[179]+2*z[142]*z[193]-k*z[210]*q2p-k*z[218]*q3p);
  z[242] = k*(4*z[12]*z[13]*z[45]-2*z[13]*z[174]-2*z[20]*z[175]-z[14]*z[221]-
  z[19]*z[225]-2*z[12]*z[14]*z[93]);
  z[243] = k*(2*z[17]*z[175]+4*z[11]*z[14]*z[45]-z[14]*z[220]-z[19]*z[224]-2*
  z[12]*z[14]*z[92]);
  z[244] = w*(2*z[137]*z[179]+2*w*z[64]*z[177]+2*w*z[13]*z[64]*z[174]+2*w*
  z[20]*z[45]*z[237]+2*w*z[20]*z[64]*z[175]-2*z[138]*z[193]-2*w*z[44]*z[237]-
  2*w*z[13]*z[43]*z[237]-4*w*z[12]*z[13]*z[45]*z[64]-z[242]*q3p-z[243]*q2p);
  z[245] = k*(2*z[11]*z[93]-z[12]*z[225]);
  z[246] = ra*(z[14]*z[177]+z[22]*z[173]);
  z[247] = k*(2*z[11]*z[92]+4*z[12]*z[45]-2*z[11]*z[175]-z[12]*z[224]);
  z[248] = w*(2*z[133]*z[179]+2*w*z[44]*z[232]+2*w*z[65]*z[177]-2*z[134]*
  z[193]-2*w*z[44]*z[246]-2*w*z[63]*z[177]-z[245]*q3p-z[247]*q2p);
  z[249] = z[11]*(z[165]+z[206]) - z[12]*(z[26]+z[84]);
  z[250] = ra*(z[12]*z[224]+2*z[11]*z[175]+2*z[104]*z[234]-4*z[12]*z[45]-4*
  z[46]*z[249]-2*z[11]*z[92]-2*z[120]*z[173]-z[34]*z[210]);
  z[251] = z[11]*z[71] + z[12]*z[85] - z[16]*z[13]*pow(z[11],2) - z[16]*z[13]*
  pow(z[12],2);
  z[252] = ra*(z[12]*z[225]+2*z[105]*z[234]-4*z[46]*z[251]-2*z[11]*z[93]-2*
  z[121]*z[173]-z[34]*z[218]);
  z[253] = w*(2*w*z[43]*z[246]+2*w*z[63]*z[174]+2*w*z[11]*z[63]*z[175]+2*w*
  z[37]*z[46]*z[246]-2*z[124]*z[179]-2*z[125]*z[193]-2*w*z[43]*z[232]-2*w*
  z[65]*z[174]-4*w*z[12]*z[45]*z[63]-4*w*z[46]*z[63]*z[169]-2*w*z[11]*z[45]*
  z[246]-2*w*z[37]*z[63]*z[173]-z[250]*q2p-z[252]*q3p);
  z[254] = z[11]*z[25] + z[11]*z[198] + z[12]*z[196] - z[12]*z[23];
  z[255] = ra*(z[14]*z[227]+z[22]*z[210]);
  z[256] = ra*(z[14]*z[228]+z[22]*z[218]+2*z[13]*z[177]-2*z[126]*z[173]);
  z[257] = w*(2*w*z[62]*z[174]+2*w*z[13]*z[62]*z[177]-2*z[129]*z[179]-2*
  z[130]*z[193]-2*w*z[43]*z[235]-4*w*z[46]*z[62]*z[169]-2*w*z[13]*z[44]*
  z[235]-2*w*z[37]*z[46]*z[235]-2*w*z[37]*z[62]*z[173]-z[255]*q2p-z[256]*q3p);
  z[258] = w*(w*z[22]*z[46]*z[246]-2*z[115]*z[193]-2*w*z[46]*z[62]*z[234]-w*
  z[22]*z[63]*z[173]-w*z[34]*z[46]*z[235]-w*z[34]*z[62]*z[173]-z[235]*q3p);
  z[259] = Izz*pow(w,2)*z[43]*z[46]*z[199]*(z[44]+z[13]*z[43]-z[20]*z[45]) + 
  0.5*Izz*pow(w,2)*z[36]*z[43]*z[173]*(z[44]+z[13]*z[43]-z[20]*z[45]) + 0.5*
  Izz*pow(w,2)*z[25]*z[45]*z[46]*(z[177]+z[13]*z[174]+z[20]*z[175]-2*z[12]*
  z[13]*z[45]) + 0.5*pow(w,2)*z[22]*z[43]*z[173]*(z[154]*z[46]+Ixy*z[19]*
  z[45]-z[161]*z[46]-Ixy*z[14]*z[43]-Iyy*z[12]*z[45]) + pow(w,2)*z[12]*z[22]*
  z[45]*z[46]*(z[154]*z[46]+Ixy*z[19]*z[45]-z[161]*z[46]-Ixy*z[14]*z[43]-Iyy*
  z[12]*z[45]) + 0.5*pow(w,2)*z[11]*z[14]*z[44]*z[175]*(z[154]*z[46]+Ixy*
  z[19]*z[45]-z[161]*z[46]-Ixy*z[14]*z[43]-Iyy*z[12]*z[45]) + 0.5*pow(w,2)*
  z[22]*z[43]*z[46]*(z[154]*z[173]+Ixy*z[14]*z[174]+Ixy*z[19]*z[175]-z[161]*
  z[173]-2*Iyy*z[11]*z[45]-Iyy*z[12]*z[175]-2*Ixy*z[12]*z[14]*z[45]) + 0.5*
  pow(w,2)*z[11]*z[14]*z[44]*z[45]*(z[154]*z[173]+Ixy*z[14]*z[174]+Ixy*z[19]*
  z[175]-z[161]*z[173]-2*Iyy*z[11]*z[45]-Iyy*z[12]*z[175]-2*Ixy*z[12]*z[14]*
  z[45]) + 0.5*Izz*z[177]*(z[14]*z[108]-z[18]*z[109]-z[113]-z[13]*z[112]-
  z[14]*z[111]-z[20]*z[110]) + 0.25*Izz*z[44]*(4*z[11]*z[13]*z[109]+z[229]+
  z[13]*z[222]+2*z[14]*z[223]-4*z[14]*z[200]-2*z[18]*z[201]-z[20]*z[226]-4*
  z[12]*z[13]*z[110]) + z[11]*z[45]*(Ixy*z[13]*z[108]+Ixy*z[17]*z[109]+Iyy*
  z[11]*z[109]+z[161]*z[114]+Ixy*z[14]*z[112]-z[154]*z[114]-Ixy*z[13]*z[111]-
  Iyy*z[12]*z[110]) + 0.5*z[12]*z[175]*(Ixy*z[13]*z[108]+Ixy*z[17]*z[109]+Iyy*
  z[11]*z[109]+z[161]*z[114]+Ixy*z[14]*z[112]-z[154]*z[114]-Ixy*z[13]*z[111]-
  Iyy*z[12]*z[110]) + 0.5*z[13]*z[174]*(Izz*z[14]*z[108]+z[16]*pow(w,2)*z[46]*(
  z[154]*z[46]+Ixy*z[19]*z[45]-z[161]*z[46]-Ixy*z[14]*z[43]-Iyy*z[12]*z[45])-
  Izz*z[18]*z[109]-Izz*z[113]-Izz*z[13]*z[112]-Izz*z[14]*z[111]-Izz*z[20]*
  z[110]) + 0.5*z[20]*z[175]*(Izz*z[14]*z[108]+z[16]*pow(w,2)*z[46]*(z[154]*
  z[46]+Ixy*z[19]*z[45]-z[161]*z[46]-Ixy*z[14]*z[43]-Iyy*z[12]*z[45])-Izz*
  z[18]*z[109]-Izz*z[113]-Izz*z[13]*z[112]-Izz*z[14]*z[111]-Izz*z[20]*z[110]) + 
  z[12]*z[14]*z[45]*(Ixx*z[13]*z[108]+Ixx*z[17]*z[109]+Ixy*z[11]*z[109]+pow(w,
  2)*z[44]*(z[154]*z[46]+Ixy*z[19]*z[45]-Ixy*z[14]*z[43]-Iyy*z[12]*z[45])+
  z[156]*z[114]+Ixx*z[14]*z[112]+Ixx*z[19]*z[110]-z[155]*z[114]-2*Ixy*z[12]*
  z[110]-Ixx*z[13]*z[111]) + 0.5*z[16]*z[173]*(Ixx*z[13]*z[108]+Ixx*z[17]*
  z[109]+Ixy*z[11]*z[109]+Ixy*pow(w,2)*z[19]*z[44]*z[45]+Izz*pow(w,2)*z[12]*
  z[45]*(z[44]+z[13]*z[43]-z[20]*z[45])+z[156]*z[114]+Ixx*z[14]*z[112]+Ixx*
  z[19]*z[110]-2*z[155]*z[114]-Ixx*z[13]*z[111]-Ixy*z[12]*z[110]) + 0.25*
  z[14]*z[43]*(4*Ixx*z[13]*z[200]+4*Ixx*z[11]*z[14]*z[109]+z[156]*z[219]+Ixx*
  z[14]*z[222]+Ixy*z[12]*z[226]-4*Ixy*z[12]*z[109]-2*Ixx*z[17]*z[201]-2*Ixy*
  z[11]*z[201]-z[155]*z[219]-4*Ixy*z[11]*z[110]-2*Ixx*z[13]*z[223]-Ixx*z[19]*
  z[226]-4*Ixx*z[12]*z[14]*z[110]) + 0.25*z[13]*z[43]*(4*Izz*z[11]*z[13]*
  z[109]+Izz*z[229]+Izz*z[13]*z[222]+2*Izz*z[14]*z[223]-4*Izz*z[14]*z[200]-2*
  Izz*z[18]*z[201]-2*z[16]*pow(w,2)*z[173]*(z[154]*z[46]+Ixy*z[19]*z[45]-
  z[161]*z[46]-Ixy*z[14]*z[43]-Iyy*z[12]*z[45])-2*z[16]*pow(w,2)*z[46]*(
  z[154]*z[173]+Ixy*z[14]*z[174]+Ixy*z[19]*z[175]-z[161]*z[173]-2*Iyy*z[11]*
  z[45]-Iyy*z[12]*z[175]-2*Ixy*z[12]*z[14]*z[45])-Izz*z[20]*z[226]-4*Izz*
  z[12]*z[13]*z[110]) + 0.25*z[16]*z[46]*(4*Ixx*z[13]*z[200]+4*Ixx*z[11]*
  z[14]*z[109]+2*Ixy*pow(w,2)*z[19]*z[44]*z[175]+2*Izz*pow(w,2)*z[12]*z[175]*(
  z[44]+z[13]*z[43]-z[20]*z[45])+4*Izz*pow(w,2)*z[11]*z[45]*(z[44]+z[13]*
  z[43]-z[20]*z[45])+z[156]*z[219]+Ixx*z[14]*z[222]+Ixy*z[12]*z[226]-4*Ixy*
  z[12]*z[109]-2*Ixx*z[17]*z[201]-2*Ixy*z[11]*z[201]-2*Ixy*pow(w,2)*z[19]*
  z[45]*z[177]-4*Ixy*pow(w,2)*z[12]*z[14]*z[44]*z[45]-2*Izz*pow(w,2)*z[12]*
  z[45]*(z[177]+z[13]*z[174]+z[20]*z[175]-2*z[12]*z[13]*z[45])-2*z[155]*
  z[219]-4*Ixy*z[11]*z[110]-2*Ixx*z[13]*z[223]-Ixx*z[19]*z[226]-4*Ixx*z[12]*
  z[14]*z[110]) - Izz*pow(w,2)*z[45]*z[46]*z[196]*(z[44]+z[13]*z[43]-z[20]*
  z[45]) - 0.5*Izz*pow(w,2)*z[25]*z[45]*z[173]*(z[44]+z[13]*z[43]-z[20]*z[45]) - 
  0.5*Izz*pow(w,2)*z[25]*z[46]*z[175]*(z[44]+z[13]*z[43]-z[20]*z[45]) - 0.5*
  Izz*pow(w,2)*z[36]*z[46]*z[174]*(z[44]+z[13]*z[43]-z[20]*z[45]) - 0.5*Izz*
  pow(w,2)*z[36]*z[43]*z[46]*(z[177]+z[13]*z[174]+z[20]*z[175]-2*z[12]*z[13]*
  z[45]) - 0.5*pow(w,2)*z[22]*z[46]*z[174]*(z[154]*z[46]+Ixy*z[19]*z[45]-
  z[161]*z[46]-Ixy*z[14]*z[43]-Iyy*z[12]*z[45]) - pow(w,2)*z[12]*z[14]*z[44]*
  z[45]*(z[154]*z[46]+Ixy*z[19]*z[45]-z[161]*z[46]-Ixy*z[14]*z[43]-Iyy*z[12]*
  z[45]) - 0.5*pow(w,2)*z[11]*z[14]*z[45]*z[177]*(z[154]*z[46]+Ixy*z[19]*
  z[45]-z[161]*z[46]-Ixy*z[14]*z[43]-Iyy*z[12]*z[45]) - 0.5*pow(w,2)*z[11]*
  z[22]*z[45]*z[173]*(z[154]*z[46]+Ixy*z[19]*z[45]-z[161]*z[46]-Ixy*z[14]*
  z[43]-Iyy*z[12]*z[45]) - 0.5*pow(w,2)*z[11]*z[22]*z[46]*z[175]*(z[154]*
  z[46]+Ixy*z[19]*z[45]-z[161]*z[46]-Ixy*z[14]*z[43]-Iyy*z[12]*z[45]) - 0.5*
  pow(w,2)*z[11]*z[22]*z[45]*z[46]*(z[154]*z[173]+Ixy*z[14]*z[174]+Ixy*z[19]*
  z[175]-z[161]*z[173]-2*Iyy*z[11]*z[45]-Iyy*z[12]*z[175]-2*Ixy*z[12]*z[14]*
  z[45]) - 0.5*z[14]*z[174]*(Ixx*z[13]*z[108]+Ixx*z[17]*z[109]+Ixy*z[11]*
  z[109]+z[156]*z[114]+Ixx*z[14]*z[112]+Ixx*z[19]*z[110]-z[155]*z[114]-Ixx*
  z[13]*z[111]-Ixy*z[12]*z[110]) - 0.25*z[12]*z[45]*(2*Ixy*z[17]*z[201]+2*Iyy*
  z[11]*z[201]+4*Iyy*z[12]*z[109]+z[154]*z[219]+2*Ixy*z[13]*z[223]+4*Iyy*
  z[11]*z[110]-4*Ixy*z[13]*z[200]-4*Ixy*z[11]*z[14]*z[109]-z[161]*z[219]-Ixy*
  z[14]*z[222]-Iyy*z[12]*z[226]) - z[12]*z[13]*z[45]*(Izz*z[14]*z[108]+z[16]*
  pow(w,2)*z[46]*(z[154]*z[46]+Ixy*z[19]*z[45]-z[161]*z[46]-Ixy*z[14]*z[43]-
  Iyy*z[12]*z[45])-Izz*z[18]*z[109]-Izz*z[113]-Izz*z[13]*z[112]-Izz*z[14]*
  z[111]-Izz*z[20]*z[110]) - 0.5*z[19]*z[175]*(Ixx*z[13]*z[108]+Ixx*z[17]*
  z[109]+Ixy*z[11]*z[109]+pow(w,2)*z[44]*(z[154]*z[46]+Ixy*z[19]*z[45]-Ixy*
  z[14]*z[43]-Iyy*z[12]*z[45])+z[156]*z[114]+Ixx*z[14]*z[112]+Ixx*z[19]*
  z[110]-z[155]*z[114]-2*Ixy*z[12]*z[110]-Ixx*z[13]*z[111]) - 0.5*z[15]*
  z[173]*(Ixy*z[13]*z[108]+Ixy*z[17]*z[109]+Iyy*z[11]*z[109]+Izz*pow(w,2)*
  z[19]*z[45]*(z[44]+z[13]*z[43]-z[20]*z[45])+Ixy*z[14]*z[112]+Ixy*z[19]*
  z[110]-Izz*pow(w,2)*z[14]*z[43]*(z[44]+z[13]*z[43]-z[20]*z[45])-z[154]*
  z[114]-Ixy*z[13]*z[111]-Iyy*z[12]*z[110]) - 0.25*z[20]*z[45]*(4*Izz*z[11]*
  z[13]*z[109]+Izz*z[229]+Izz*z[13]*z[222]+2*Izz*z[14]*z[223]-4*Izz*z[14]*
  z[200]-2*Izz*z[18]*z[201]-2*z[16]*pow(w,2)*z[173]*(z[154]*z[46]+Ixy*z[19]*
  z[45]-z[161]*z[46]-Ixy*z[14]*z[43]-Iyy*z[12]*z[45])-2*z[16]*pow(w,2)*z[46]*(
  z[154]*z[173]+Ixy*z[14]*z[174]+Ixy*z[19]*z[175]-z[161]*z[173]-2*Iyy*z[11]*
  z[45]-Iyy*z[12]*z[175]-2*Ixy*z[12]*z[14]*z[45])-Izz*z[20]*z[226]-4*Izz*
  z[12]*z[13]*z[110]) - 0.25*z[19]*z[45]*(4*Ixx*z[13]*z[200]+4*Ixx*z[11]*
  z[14]*z[109]+2*pow(w,2)*z[44]*(z[154]*z[173]+Ixy*z[14]*z[174]+Ixy*z[19]*
  z[175]-2*Iyy*z[11]*z[45]-Iyy*z[12]*z[175]-2*Ixy*z[12]*z[14]*z[45])+z[156]*
  z[219]+Ixx*z[14]*z[222]+2*Ixy*z[12]*z[226]-4*Ixy*z[12]*z[109]-2*Ixx*z[17]*
  z[201]-2*Ixy*z[11]*z[201]-2*pow(w,2)*z[177]*(z[154]*z[46]+Ixy*z[19]*z[45]-
  Ixy*z[14]*z[43]-Iyy*z[12]*z[45])-z[155]*z[219]-8*Ixy*z[11]*z[110]-2*Ixx*
  z[13]*z[223]-Ixx*z[19]*z[226]-4*Ixx*z[12]*z[14]*z[110]) - 0.25*z[15]*z[46]*(
  4*Ixy*z[13]*z[200]+4*Ixy*z[11]*z[14]*z[109]+2*Izz*pow(w,2)*z[14]*z[174]*(
  z[44]+z[13]*z[43]-z[20]*z[45])+2*Izz*pow(w,2)*z[19]*z[175]*(z[44]+z[13]*
  z[43]-z[20]*z[45])+2*Izz*pow(w,2)*z[14]*z[43]*(z[177]+z[13]*z[174]+z[20]*
  z[175]-2*z[12]*z[13]*z[45])+Ixy*z[14]*z[222]+Iyy*z[12]*z[226]-4*Iyy*z[12]*
  z[109]-2*Ixy*z[17]*z[201]-2*Iyy*z[11]*z[201]-4*Izz*pow(w,2)*z[12]*z[14]*
  z[45]*(z[44]+z[13]*z[43]-z[20]*z[45])-2*Izz*pow(w,2)*z[19]*z[45]*(z[177]+
  z[13]*z[174]+z[20]*z[175]-2*z[12]*z[13]*z[45])-z[154]*z[219]-4*Iyy*z[11]*
  z[110]-2*Ixy*z[13]*z[223]-Ixy*z[19]*z[226]-4*Ixy*z[12]*z[14]*z[110]) - 0.25*
  m*(2*z[157]*z[12]*z[45]*z[231]+2*z[157]*z[12]*z[152]*z[175]+4*z[157]*z[11]*
  z[45]*z[152]+2*k*z[12]*z[13]*z[45]*z[233]+2*k*z[12]*z[13]*z[143]*z[175]+2*k*
  z[12]*z[17]*z[45]*z[236]+2*k*z[12]*z[17]*z[144]*z[175]+2*ra*z[12]*z[22]*
  z[45]*z[231]+2*ra*z[12]*z[22]*z[152]*z[175]+2*ra*z[14]*z[34]*z[152]*z[177]+
  4*k*z[11]*z[13]*z[45]*z[143]+4*k*z[11]*z[17]*z[45]*z[144]+4*ra*z[11]*z[22]*
  z[45]*z[152]+4*k*z[11]*z[12]*z[14]*z[45]*z[144]+2*ra*z[233]*(z[12]*z[45]-
  z[34]*z[46])+2*z[158]*z[231]*(z[14]*z[43]-z[19]*z[45])+2*ra*z[11]*z[236]*(
  z[14]*z[44]-z[22]*z[46])+2*ra*z[14]*z[238]*(z[12]*z[45]-z[34]*z[46])+2*ra*
  z[14]*z[239]*(z[12]*z[45]-z[34]*z[46])+2*ra*z[35]*z[239]*(z[14]*z[44]-z[22]*
  z[46])+4*k*z[12]*z[144]*(z[14]*z[43]-z[19]*z[45])+4*ra*z[153]*z[240]*(z[14]*
  z[44]-z[22]*z[46])+2*k*z[11]*z[144]*(z[14]*z[174]+z[19]*z[175]-2*z[12]*
  z[14]*z[45])+2*ra*z[143]*(z[12]*z[175]+2*z[11]*z[45]-2*z[46]*z[234]-z[34]*
  z[173])+2*ra*z[14]*z[150]*(z[12]*z[175]+2*z[11]*z[45]-2*z[46]*z[234]-z[34]*
  z[173])+2*ra*z[14]*z[153]*(z[12]*z[175]+2*z[11]*z[45]-2*z[46]*z[234]-z[34]*
  z[173])+2*k*z[173]*z[151]+2*z[157]*z[173]*z[149]+2*z[158]*z[173]*z[148]+k*
  z[12]*z[45]*z[248]+k*z[21]*z[46]*z[253]+z[158]*z[12]*z[45]*z[241]+2*k*z[21]*
  z[173]*z[145]+2*k*z[33]*z[173]*z[146]+2*k*z[36]*z[46]*z[258]+2*k*z[36]*
  z[173]*z[147]+4*k*z[46]*z[199]*z[147]+4*k*z[46]*z[254]*z[146]+2*k*z[12]*
  z[14]*z[45]*z[258]+2*k*z[12]*z[14]*z[175]*z[147]+4*k*z[11]*z[14]*z[45]*
  z[147]+2*ra*(z[14]*z[177]+z[22]*z[173])*z[146]+2*ra*(z[14]*z[177]+z[22]*
  z[173])*z[149]+ra*(z[14]*z[44]-z[22]*z[46])*z[244]+ra*(z[14]*z[44]-z[22]*
  z[46])*z[257]+2*ra*z[33]*(z[14]*z[177]+z[22]*z[173])*z[151]+ra*z[13]*(z[12]*
  z[45]-z[34]*z[46])*z[248]+ra*z[21]*(z[12]*z[45]-z[34]*z[46])*z[241]+ra*
  z[33]*(z[14]*z[44]-z[22]*z[46])*z[241]-4*k*z[46]*z[144]*z[198]-2*k*z[21]*
  z[46]*z[233]-2*k*z[21]*z[143]*z[173]-2*k*z[23]*z[46]*z[236]-2*k*z[23]*
  z[144]*z[173]-4*ra*z[14]*z[44]*z[152]*z[234]-2*ra*z[14]*z[34]*z[44]*z[231]-
  2*ra*z[11]*z[144]*(z[14]*z[177]+z[22]*z[173])-2*ra*z[35]*z[153]*(z[14]*
  z[177]+z[22]*z[173])-4*ra*z[12]*z[144]*(z[14]*z[44]-z[22]*z[46])-2*k*z[11]*
  z[236]*(z[14]*z[43]-z[19]*z[45])-2*z[158]*z[152]*(z[14]*z[174]+z[19]*z[175]-
  2*z[12]*z[14]*z[45])-k*z[46]*z[241]-z[157]*z[46]*z[244]-z[158]*z[46]*z[248]-
  4*k*z[11]*z[45]*z[148]-4*z[158]*z[11]*z[45]*z[151]-2*k*z[12]*z[175]*z[148]-
  2*z[158]*z[12]*z[175]*z[151]-k*z[33]*z[46]*z[257]-4*k*z[11]*z[13]*z[45]*
  z[145]-2*k*z[12]*z[13]*z[175]*z[145]-k*z[12]*z[13]*z[45]*z[253]-k*(z[14]*
  z[43]-z[19]*z[45])*z[244]-k*(z[14]*z[43]-z[19]*z[45])*z[257]-ra*(z[12]*
  z[45]-z[34]*z[46])*z[253]-z[157]*(z[14]*z[43]-z[19]*z[45])*z[241]-4*ra*
  z[254]*(z[14]*z[44]-z[22]*z[46])*z[151]-2*k*(z[14]*z[174]+z[19]*z[175]-2*
  z[12]*z[14]*z[45])*z[146]-2*k*(z[14]*z[174]+z[19]*z[175]-2*z[12]*z[14]*
  z[45])*z[149]-2*z[157]*(z[14]*z[174]+z[19]*z[175]-2*z[12]*z[14]*z[45])*
  z[151]-2*ra*(z[12]*z[175]+2*z[11]*z[45]-2*z[46]*z[234]-z[34]*z[173])*z[145]-
  2*ra*z[13]*(z[12]*z[175]+2*z[11]*z[45]-2*z[46]*z[234]-z[34]*z[173])*z[148]-
  2*ra*z[21]*(z[12]*z[175]+2*z[11]*z[45]-2*z[46]*z[234]-z[34]*z[173])*z[151]);
  z[260] = m*(k*z[12]*z[14]*z[186]+2*z[158]*z[11]*z[13]*z[46]-k*z[25]*z[185]-
  2*k*z[12]*z[13]*z[43]-ra*z[12]*(z[14]*z[189]+z[22]*z[185]-2*z[13]*z[44]-2*
  z[16]*z[14]*z[46]));
  z[261] = z[15]*z[13]*(pow(z[11],2)+pow(z[12],2));
  z[262] = 0.5*w*z[187]*(z[12]*z[68]+z[18]*z[69]-z[24]*z[70]) - 0.5*z[67]*(w*
  z[12]*z[186]+w*z[18]*z[189]+w*z[24]*z[185]+2*z[12]*z[14]*z[69]-2*z[16]*
  z[12]*z[13]*z[70]);
  z[263] = 0.5*w*z[187]*(z[14]*z[69]-z[22]*z[70]) + 0.5*z[67]*(2*z[13]*z[69]+
  2*z[16]*z[14]*z[70]-w*z[14]*z[189]-w*z[22]*z[185]);
  z[264] = z[16]*z[13]*(z[11]*z[24]-z[12]*z[26]);
  z[265] = (z[27]*z[264]+z[72]*z[180])/pow(z[27],1.5);
  z[266] = (z[28]*z[265]+2*z[74]*z[180]/pow(z[27],0.5))/pow(z[28],3);
  z[267] = (z[180]*(z[24]*z[28]+2*z[26]*z[74])/pow(z[27],0.5)+z[28]*(z[26]*
  z[265]+z[16]*z[11]*z[13]*z[74]-z[16]*z[12]*z[13]*z[28]))/pow(z[28],3);
  z[268] = 2*z[78]*z[182] + 2*l*z[18]*z[182] + 2*ra*z[12]*z[182] + 2*ra*z[82]*
  z[183] + 2*rb*z[31]*z[266] + 2*rb*z[32]*z[267] + 2*rb*z[82]*z[181] + 2*
  z[170]*z[37]*z[267] + 2*l*z[11]*z[14]*z[78] + 2*z[16]*z[12]*z[13]*z[31]*
  z[32] - 2*z[170]*z[11]*z[266] - 2*z[170]*z[86]*z[181] - 2*z[171]*z[20]*
  z[266] - 2*z[24]*z[32]*z[182] - 2*z[26]*z[82]*z[182] - 2*l*z[12]*z[14]*
  z[31] - 2*rb*z[24]*z[31]*z[181] - 2*rb*z[26]*z[31]*z[267] - 2*rb*z[26]*
  z[32]*z[266] - 2*rb*z[26]*z[78]*z[181] - 2*z[16]*z[11]*z[13]*z[31]*z[82] - 
  2*z[16]*z[11]*z[13]*z[32]*z[78];
  z[269] = (2*z[41]*z[268]-z[88]*z[184])/pow(z[41],1.5);
  z[270] = (2*z[32]*z[90]*z[184]/pow(z[41],0.5)+z[42]*(4*rb*z[42]*z[267]-
  z[32]*z[269]-2*rb*z[90]*z[181]-2*z[82]*z[184]/pow(z[41],0.5)))/pow(z[42],3);
  z[271] = z[16]*z[11]*(z[13]*z[71]-z[14]*z[26]);
  z[272] = (z[27]*z[271]+z[73]*z[180])/pow(z[27],1.5);
  z[273] = (z[28]*z[272]+2*z[75]*z[180]/pow(z[27],0.5))/pow(z[28],3);
  z[274] = (z[180]*(z[28]*z[71]+2*z[26]*z[75])/pow(z[27],0.5)+z[28]*(z[26]*
  z[272]+z[16]*z[11]*z[13]*z[75]-z[16]*z[11]*z[14]*z[28]))/pow(z[28],3);
  z[275] = z[16]*z[14]*(pow(z[11],2)+pow(z[12],2));
  z[276] = 2*z[79]*z[182] + 2*l*z[19]*z[182] + 2*ra*z[83]*z[183] + 2*rb*z[31]*
  z[273] + 2*rb*z[32]*z[274] + 2*rb*z[83]*z[181] + 2*z[170]*z[37]*z[274] + 2*
  z[170]*z[87]*z[181] + 2*l*z[11]*z[13]*z[31] + 2*l*z[11]*z[14]*z[79] + 2*
  z[16]*z[11]*z[14]*z[31]*z[32] - 2*z[40]*z[13] - 2*ra*z[32]*z[275] - 2*
  z[170]*z[11]*z[273] - 2*z[171]*z[20]*z[273] - 2*z[26]*z[83]*z[182] - 2*
  z[32]*z[71]*z[182] - 2*rb*z[26]*z[31]*z[274] - 2*rb*z[26]*z[32]*z[273] - 2*
  rb*z[26]*z[79]*z[181] - 2*rb*z[31]*z[71]*z[181] - 2*z[16]*z[11]*z[13]*z[31]*
  z[83] - 2*z[16]*z[11]*z[13]*z[32]*z[79];
  z[277] = (2*z[41]*z[276]-z[89]*z[184])/pow(z[41],1.5);
  z[278] = (2*z[32]*z[91]*z[184]/pow(z[41],0.5)+z[42]*(4*rb*z[42]*z[274]-
  z[32]*z[277]-2*rb*z[91]*z[181]-2*z[83]*z[184]/pow(z[41],0.5)))/pow(z[42],3);
  z[279] = w*(2*z[106]*z[191]+2*z[107]*z[195]-z[270]*q2p-z[278]*q3p);
  z[280] = ra*(z[42]*z[269]-2*z[90]*z[184]/pow(z[41],0.5))/pow(z[42],3);
  z[281] = ra*(z[42]*z[277]-2*z[91]*z[184]/pow(z[41],0.5))/pow(z[42],3);
  z[282] = w*(2*z[98]*z[191]+2*z[99]*z[195]+z[280]*q2p+z[281]*q3p);
  z[283] = w*(2*z[68]*z[195]-z[186]*q3p);
  z[284] = (2*z[31]*z[90]*z[184]/pow(z[41],0.5)+z[42]*(4*rb*z[42]*z[266]-2*
  z[90]*z[182]-z[31]*z[269]-2*z[78]*z[184]/pow(z[41],0.5)))/pow(z[42],3);
  z[285] = (2*z[31]*z[91]*z[184]/pow(z[41],0.5)+z[42]*(4*rb*z[42]*z[273]-2*
  z[91]*z[182]-z[31]*z[277]-2*z[79]*z[184]/pow(z[41],0.5)))/pow(z[42],3);
  z[286] = w*(2*z[94]*z[191]+2*z[95]*z[195]-z[284]*q2p-z[285]*q3p);
  z[287] = l*(z[42]*z[269]-2*z[90]*z[184]/pow(z[41],0.5))/pow(z[42],3);
  z[288] = l*(z[42]*z[277]-2*z[91]*z[184]/pow(z[41],0.5))/pow(z[42],3);
  z[289] = w*(2*z[102]*z[191]+2*z[103]*z[195]+z[287]*q2p+z[288]*q3p);
  z[290] = pow(w,2)*(k*z[185]*(z[20]*z[45]-z[44]-z[38]*z[43])-z[66]*(2*z[11]*
  z[14]*z[45]-z[189]-z[20]*z[187]-z[38]*z[186]-2*z[14]*z[43]*(pow(z[11],2)+
  pow(z[12],2))));
  z[291] = k*(2*z[13]*z[43]-z[14]*z[186]-z[19]*z[187]-2*z[11]*z[13]*z[45]);
  z[292] = pow(w,2)*z[11]*(z[45]*z[291]+z[65]*z[187]);
  z[293] = ra*(z[12]*z[187]-z[34]*z[185]);
  z[294] = pow(w,2)*(z[45]*z[293]+z[62]*z[187]);
  z[295] = pow(w,2)*(z[15]*z[64]*z[185]+z[158]*z[12]*z[46]*z[187]-z[16]*z[46]*
  z[291]-z[16]*z[65]*z[185]-z[12]*z[64]*z[187]-k*z[45]*z[187]*pow(z[12],2));
  z[296] = pow(w,2)*(k*z[185]*(z[26]*z[45]-z[46]-z[37]*z[43])-z[66]*(z[185]+2*
  z[43]*z[183]-z[26]*z[187]-z[37]*z[186]-2*z[16]*z[11]*z[13]*z[45]));
  z[297] = w*(2*z[141]*z[191]+2*z[142]*z[195]-k*z[270]*q2p-k*z[278]*q3p);
  z[298] = k*(z[14]*z[281]+z[19]*z[285]+2*z[13]*z[97]+2*z[13]*z[186]+2*z[20]*
  z[187]+4*z[14]*z[43]-4*z[11]*z[14]*z[45]-2*z[11]*z[13]*z[93]);
  z[299] = k*(z[14]*z[280]+z[19]*z[284]+2*z[13]*z[96]-2*z[17]*z[187]-4*z[12]*
  z[13]*z[45]-2*z[11]*z[13]*z[92]);
  z[300] = w*(2*z[138]*z[195]+2*k*w*z[12]*z[44]*z[187]+4*w*z[11]*z[14]*z[45]*
  z[64]+2*k*w*z[12]*z[13]*z[43]*z[187]-2*z[137]*z[191]-2*w*z[64]*z[189]-4*w*
  z[14]*z[43]*z[64]-2*w*z[13]*z[64]*z[186]-2*w*z[20]*z[64]*z[187]-2*k*w*z[12]*
  z[20]*z[45]*z[187]-z[298]*q3p-z[299]*q2p);
  z[301] = k*w*z[12]*z[285];
  z[302] = ra*(z[14]*z[189]+z[22]*z[185]-2*z[13]*z[44]-2*z[16]*z[14]*z[46]);
  z[303] = k*(z[12]*z[284]+2*z[11]*z[187]);
  z[304] = 0.5*w*z[134]*z[195] + 0.5*pow(w,2)*z[44]*z[291] + 0.5*pow(w,2)*
  z[44]*z[302] + 0.5*pow(w,2)*z[63]*z[189] - 0.5*w*z[133]*z[191] - 0.5*pow(w,
  2)*z[65]*z[189] - 0.25*z[301]*q3p - 0.25*w*z[303]*q2p;
  z[305] = ra*(z[12]*z[284]+2*z[11]*z[187]-2*z[120]*z[185]-z[34]*z[270]);
  z[306] = ra*(z[12]*z[285]-2*z[121]*z[185]-z[34]*z[278]);
  z[307] = w*(2*w*z[43]*z[291]+2*w*z[43]*z[302]+2*w*z[63]*z[186]+2*w*z[11]*
  z[63]*z[187]+2*w*z[37]*z[46]*z[302]-2*z[124]*z[191]-2*z[125]*z[195]-2*w*
  z[65]*z[186]-4*w*z[46]*z[63]*z[183]-2*w*z[11]*z[45]*z[302]-2*w*z[37]*z[63]*
  z[185]-z[305]*q2p-z[306]*q3p);
  z[308] = ra*(z[14]*z[287]+z[22]*z[270]+2*z[13]*z[100]+2*z[16]*z[14]*z[104]);
  z[309] = ra*(2*z[126]*z[185]+4*z[16]*z[13]*z[46]-4*z[14]*z[44]-2*z[13]*
  z[101]-2*z[13]*z[189]-z[14]*z[288]-z[22]*z[278]-2*z[16]*z[14]*z[105]);
  z[310] = w*(2*z[129]*z[191]+2*z[130]*z[195]+2*w*z[43]*z[293]+2*w*z[13]*
  z[44]*z[293]+2*w*z[37]*z[46]*z[293]+2*w*z[37]*z[62]*z[185]+4*w*z[46]*z[62]*
  z[183]+z[308]*q2p-2*w*z[62]*z[186]-4*w*z[14]*z[44]*z[62]-2*w*z[13]*z[62]*
  z[189]-z[309]*q3p);
  z[311] = w*(w*z[22]*z[46]*z[302]+2*z[16]*w*z[14]*z[46]*z[63]-2*z[115]*
  z[195]-w*z[22]*z[63]*z[185]-w*z[34]*z[46]*z[293]-w*z[34]*z[62]*z[185]-
  z[293]*q3p);
  z[315] = 0.5*Izz*pow(w,2)*z[36]*z[43]*z[185]*(z[44]+z[13]*z[43]-z[20]*z[45]) + 
  z[312]*pow(w,2)*z[11]*z[13]*z[45]*z[46]*(z[44]+z[13]*z[43]-z[20]*z[45]) + 
  0.5*Izz*pow(w,2)*z[25]*z[45]*z[46]*(z[189]+z[13]*z[186]+z[20]*z[187]+2*
  z[14]*z[43]-2*z[11]*z[14]*z[45]) + 0.5*pow(w,2)*z[22]*z[43]*z[185]*(z[154]*
  z[46]+Ixy*z[19]*z[45]-z[161]*z[46]-Ixy*z[14]*z[43]-Iyy*z[12]*z[45]) + pow(w,
  2)*z[11]*z[13]*z[44]*z[45]*(z[154]*z[46]+Ixy*z[19]*z[45]-z[161]*z[46]-Ixy*
  z[14]*z[43]-Iyy*z[12]*z[45]) + 0.5*pow(w,2)*z[11]*z[14]*z[44]*z[187]*(
  z[154]*z[46]+Ixy*z[19]*z[45]-z[161]*z[46]-Ixy*z[14]*z[43]-Iyy*z[12]*z[45]) + 
  z[16]*pow(w,2)*z[11]*z[14]*z[45]*z[46]*(z[154]*z[46]+Ixy*z[19]*z[45]-z[161]*
  z[46]-Ixy*z[14]*z[43]-Iyy*z[12]*z[45]) + 0.5*pow(w,2)*z[11]*z[22]*z[45]*
  z[46]*(z[161]*z[185]+Iyy*z[12]*z[187]+2*Ixy*z[13]*z[43]-z[154]*z[185]-Ixy*
  z[14]*z[186]-Ixy*z[19]*z[187]-2*Ixy*z[11]*z[13]*z[45]) + 0.5*Izz*z[189]*(
  z[14]*z[108]-z[18]*z[109]-z[113]-z[13]*z[112]-z[14]*z[111]-z[20]*z[110]) + 
  0.5*z[12]*z[187]*(Ixy*z[13]*z[108]+Ixy*z[17]*z[109]+Iyy*z[11]*z[109]+z[161]*
  z[114]+Ixy*z[14]*z[112]-z[154]*z[114]-Ixy*z[13]*z[111]-Iyy*z[12]*z[110]) + 
  z[13]*z[43]*(Ixx*z[13]*z[108]+Ixx*z[17]*z[109]+Ixy*z[11]*z[109]+z[156]*
  z[114]+Ixx*z[14]*z[112]+Ixx*z[19]*z[110]-z[155]*z[114]-Ixx*z[13]*z[111]-Ixy*
  z[12]*z[110]) + 0.25*Izz*z[44]*(4*z[18]*z[263]+z[289]+z[13]*z[282]+2*z[14]*
  z[283]+4*z[13]*z[111]-4*z[13]*z[108]-4*z[14]*z[262]-4*z[12]*z[14]*z[109]-4*
  z[14]*z[112]-z[20]*z[286]-4*z[11]*z[14]*z[110]) + z[14]*z[43]*(Izz*z[14]*
  z[108]+z[16]*pow(w,2)*z[46]*(z[154]*z[46]+Ixy*z[19]*z[45]-z[161]*z[46]-Ixy*
  z[14]*z[43]-Iyy*z[12]*z[45])-Izz*z[18]*z[109]-Izz*z[113]-Izz*z[13]*z[112]-
  Izz*z[14]*z[111]-Izz*z[20]*z[110]) + 0.5*z[13]*z[186]*(Izz*z[14]*z[108]+
  z[16]*pow(w,2)*z[46]*(z[154]*z[46]+Ixy*z[19]*z[45]-z[161]*z[46]-Ixy*z[14]*
  z[43]-Iyy*z[12]*z[45])-Izz*z[18]*z[109]-Izz*z[113]-Izz*z[13]*z[112]-Izz*
  z[14]*z[111]-Izz*z[20]*z[110]) + 0.5*z[20]*z[187]*(Izz*z[14]*z[108]+z[16]*
  pow(w,2)*z[46]*(z[154]*z[46]+Ixy*z[19]*z[45]-z[161]*z[46]-Ixy*z[14]*z[43]-
  Iyy*z[12]*z[45])-Izz*z[18]*z[109]-Izz*z[113]-Izz*z[13]*z[112]-Izz*z[14]*
  z[111]-Izz*z[20]*z[110]) + 0.5*z[16]*z[185]*(Ixx*z[13]*z[108]+Ixx*z[17]*
  z[109]+Ixy*z[11]*z[109]+Ixy*pow(w,2)*z[19]*z[44]*z[45]+Izz*pow(w,2)*z[12]*
  z[45]*(z[44]+z[13]*z[43]-z[20]*z[45])+z[156]*z[114]+Ixx*z[14]*z[112]+Ixx*
  z[19]*z[110]-2*z[155]*z[114]-Ixx*z[13]*z[111]-Ixy*z[12]*z[110]) + 0.25*
  z[13]*z[43]*(4*Izz*z[18]*z[263]+2*z[16]*pow(w,2)*z[46]*(z[161]*z[185]+Iyy*
  z[12]*z[187]+2*Ixy*z[13]*z[43]-z[154]*z[185]-Ixy*z[14]*z[186]-Ixy*z[19]*
  z[187]-2*Ixy*z[11]*z[13]*z[45])+Izz*z[289]+Izz*z[13]*z[282]+2*Izz*z[14]*
  z[283]+4*Izz*z[13]*z[111]-4*Izz*z[13]*z[108]-4*Izz*z[14]*z[262]-4*Izz*z[12]*
  z[14]*z[109]-2*z[16]*pow(w,2)*z[185]*(z[154]*z[46]+Ixy*z[19]*z[45]-z[161]*
  z[46]-Ixy*z[14]*z[43]-Iyy*z[12]*z[45])-4*Izz*z[14]*z[112]-Izz*z[20]*z[286]-
  4*Izz*z[11]*z[14]*z[110]) + 0.25*z[19]*z[45]*(4*Ixx*z[14]*z[108]+2*pow(w,2)*
  z[189]*(z[154]*z[46]+Ixy*z[19]*z[45]-Ixy*z[14]*z[43]-Iyy*z[12]*z[45])+2*
  pow(w,2)*z[44]*(Iyy*z[12]*z[187]+2*Ixy*z[13]*z[43]-z[154]*z[185]-Ixy*z[14]*
  z[186]-Ixy*z[19]*z[187]-2*Ixy*z[11]*z[13]*z[45])+z[155]*z[279]+Ixx*z[19]*
  z[286]+2*Ixx*z[13]*z[283]-4*Ixx*z[13]*z[262]-4*Ixx*z[17]*z[263]-4*Ixy*z[11]*
  z[263]-4*Ixx*z[12]*z[13]*z[109]-z[156]*z[279]-4*Ixx*z[13]*z[112]-4*Ixx*
  z[14]*z[111]-2*Ixy*z[12]*z[286]-Ixx*z[14]*z[282]-4*Ixx*z[11]*z[13]*z[110]) + 
  0.25*z[15]*z[46]*(4*Ixy*z[14]*z[108]+4*Izz*pow(w,2)*z[13]*z[43]*(z[44]+
  z[13]*z[43]-z[20]*z[45])+2*Izz*pow(w,2)*z[19]*z[45]*(z[189]+z[13]*z[186]+
  z[20]*z[187]+2*z[14]*z[43]-2*z[11]*z[14]*z[45])+z[154]*z[279]+Ixy*z[19]*
  z[286]+2*Ixy*z[13]*z[283]-4*Ixy*z[13]*z[262]-4*Ixy*z[17]*z[263]-4*Iyy*z[11]*
  z[263]-4*Ixy*z[12]*z[13]*z[109]-2*Izz*pow(w,2)*z[14]*z[186]*(z[44]+z[13]*
  z[43]-z[20]*z[45])-2*Izz*pow(w,2)*z[19]*z[187]*(z[44]+z[13]*z[43]-z[20]*
  z[45])-4*Izz*pow(w,2)*z[11]*z[13]*z[45]*(z[44]+z[13]*z[43]-z[20]*z[45])-2*
  Izz*pow(w,2)*z[14]*z[43]*(z[189]+z[13]*z[186]+z[20]*z[187]+2*z[14]*z[43]-2*
  z[11]*z[14]*z[45])-4*Ixy*z[13]*z[112]-4*Ixy*z[14]*z[111]-Ixy*z[14]*z[282]-
  Iyy*z[12]*z[286]-4*Ixy*z[11]*z[13]*z[110]) + 0.25*m*(2*k*z[21]*z[46]*z[292]+
  2*k*z[21]*z[143]*z[185]+2*k*z[23]*z[46]*z[294]+2*k*z[23]*z[144]*z[185]+2*ra*
  z[14]*z[34]*z[44]*z[290]+4*k*z[12]*z[14]*z[45]*z[143]+4*ra*z[13]*z[34]*
  z[44]*z[152]+4*z[158]*z[12]*z[13]*z[46]*z[144]+4*z[313]*z[12]*z[14]*z[45]*
  z[152]+2*k*z[11]*z[294]*(z[14]*z[43]-z[19]*z[45])+2*ra*z[11]*z[144]*(z[14]*
  z[189]+z[22]*z[185]-2*z[13]*z[44]-2*z[16]*z[14]*z[46])+2*ra*z[35]*z[153]*(
  z[14]*z[189]+z[22]*z[185]-2*z[13]*z[44]-2*z[16]*z[14]*z[46])+2*k*z[11]*
  z[144]*(2*z[13]*z[43]-z[14]*z[186]-z[19]*z[187]-2*z[11]*z[13]*z[45])+k*
  z[46]*z[297]+2*k*z[12]*z[187]*z[148]+2*z[158]*z[12]*z[187]*z[151]+4*k*z[12]*
  z[45]*z[304]+4*k*z[46]*z[261]*z[147]+4*z[158]*z[14]*z[46]*z[145]+k*z[12]*
  z[13]*z[45]*z[307]+2*k*z[12]*z[13]*z[187]*z[145]+ra*(z[12]*z[45]-z[34]*
  z[46])*z[307]+ra*(z[14]*z[44]-z[22]*z[46])*z[300]+ra*(z[14]*z[44]-z[22]*
  z[46])*z[310]+z[157]*(z[14]*z[43]-z[19]*z[45])*z[297]+2*ra*(z[12]*z[187]-
  z[34]*z[185])*z[145]+2*ra*z[13]*(z[12]*z[187]-z[34]*z[185])*z[148]+2*ra*
  z[21]*(z[12]*z[187]-z[34]*z[185])*z[151]+4*ra*z[13]*(z[12]*z[45]-z[34]*
  z[46])*z[304]-4*z[158]*z[14]*z[46]*z[143]-2*z[157]*z[12]*z[45]*z[290]-2*
  z[157]*z[12]*z[152]*z[187]-2*k*z[12]*z[13]*z[45]*z[292]-2*k*z[12]*z[13]*
  z[143]*z[187]-2*k*z[12]*z[17]*z[45]*z[294]-2*k*z[12]*z[17]*z[144]*z[187]-2*
  ra*z[12]*z[22]*z[45]*z[290]-2*ra*z[12]*z[22]*z[152]*z[187]-2*ra*z[14]*z[34]*
  z[152]*z[189]-4*k*z[13]*z[45]*z[144]*pow(z[12],2)-2*ra*z[143]*(z[12]*z[187]-
  z[34]*z[185])-2*ra*z[292]*(z[12]*z[45]-z[34]*z[46])-2*z[158]*z[290]*(z[14]*
  z[43]-z[19]*z[45])-4*ra*z[13]*z[150]*(z[12]*z[45]-z[34]*z[46])-4*ra*z[13]*
  z[153]*(z[12]*z[45]-z[34]*z[46])-2*ra*z[11]*z[294]*(z[14]*z[44]-z[22]*z[46])-
  2*ra*z[14]*z[150]*(z[12]*z[187]-z[34]*z[185])-2*ra*z[14]*z[153]*(z[12]*
  z[187]-z[34]*z[185])-2*ra*z[14]*z[295]*(z[12]*z[45]-z[34]*z[46])-2*ra*z[14]*
  z[296]*(z[12]*z[45]-z[34]*z[46])-2*ra*z[35]*z[296]*(z[14]*z[44]-z[22]*z[46])-
  2*z[158]*z[152]*(2*z[13]*z[43]-z[14]*z[186]-z[19]*z[187]-2*z[11]*z[13]*
  z[45])-4*z[158]*z[46]*z[304]-2*k*z[185]*z[151]-2*z[157]*z[185]*z[149]-2*
  z[158]*z[185]*z[148]-z[157]*z[46]*z[300]-2*k*z[21]*z[185]*z[145]-2*k*z[33]*
  z[185]*z[146]-2*k*z[36]*z[46]*z[311]-2*k*z[36]*z[185]*z[147]-k*z[21]*z[46]*
  z[307]-k*z[33]*z[46]*z[310]-z[158]*z[12]*z[45]*z[297]-4*k*z[12]*z[13]*z[45]*
  z[147]-4*k*z[12]*z[14]*z[45]*z[145]-2*k*z[12]*z[14]*z[45]*z[311]-2*k*z[12]*
  z[14]*z[187]*z[147]-k*(z[14]*z[43]-z[19]*z[45])*z[300]-k*(z[14]*z[43]-z[19]*
  z[45])*z[310]-4*ra*z[14]*(z[12]*z[45]-z[34]*z[46])*z[148]-4*z[314]*z[14]*(
  z[12]*z[45]-z[34]*z[46])*z[151]-ra*z[21]*(z[12]*z[45]-z[34]*z[46])*z[297]-
  ra*z[33]*(z[14]*z[44]-z[22]*z[46])*z[297]-2*ra*(z[14]*z[189]+z[22]*z[185]-2*
  z[13]*z[44]-2*z[16]*z[14]*z[46])*z[146]-2*ra*(z[14]*z[189]+z[22]*z[185]-2*
  z[13]*z[44]-2*z[16]*z[14]*z[46])*z[149]-2*ra*z[33]*(z[14]*z[189]+z[22]*
  z[185]-2*z[13]*z[44]-2*z[16]*z[14]*z[46])*z[151]-2*k*(2*z[13]*z[43]-z[14]*
  z[186]-z[19]*z[187]-2*z[11]*z[13]*z[45])*z[146]-2*k*(2*z[13]*z[43]-z[14]*
  z[186]-z[19]*z[187]-2*z[11]*z[13]*z[45])*z[149]-2*z[157]*(2*z[13]*z[43]-
  z[14]*z[186]-z[19]*z[187]-2*z[11]*z[13]*z[45])*z[151]) - Izz*pow(w,2)*z[43]*
  z[46]*z[261]*(z[44]+z[13]*z[43]-z[20]*z[45]) - 0.5*Izz*pow(w,2)*z[25]*z[45]*
  z[185]*(z[44]+z[13]*z[43]-z[20]*z[45]) - 0.5*Izz*pow(w,2)*z[25]*z[46]*
  z[187]*(z[44]+z[13]*z[43]-z[20]*z[45]) - 0.5*Izz*pow(w,2)*z[36]*z[46]*
  z[186]*(z[44]+z[13]*z[43]-z[20]*z[45]) - 0.5*Izz*pow(w,2)*z[36]*z[43]*z[46]*(
  z[189]+z[13]*z[186]+z[20]*z[187]+2*z[14]*z[43]-2*z[11]*z[14]*z[45]) - 0.5*
  pow(w,2)*z[22]*z[46]*z[186]*(z[154]*z[46]+Ixy*z[19]*z[45]-z[161]*z[46]-Ixy*
  z[14]*z[43]-Iyy*z[12]*z[45]) - z[16]*pow(w,2)*z[14]*z[43]*z[46]*(z[154]*
  z[46]+Ixy*z[19]*z[45]-z[161]*z[46]-Ixy*z[14]*z[43]-Iyy*z[12]*z[45]) - 0.5*
  pow(w,2)*z[11]*z[14]*z[45]*z[189]*(z[154]*z[46]+Ixy*z[19]*z[45]-z[161]*
  z[46]-Ixy*z[14]*z[43]-Iyy*z[12]*z[45]) - 0.5*pow(w,2)*z[11]*z[22]*z[45]*
  z[185]*(z[154]*z[46]+Ixy*z[19]*z[45]-z[161]*z[46]-Ixy*z[14]*z[43]-Iyy*z[12]*
  z[45]) - 0.5*pow(w,2)*z[11]*z[22]*z[46]*z[187]*(z[154]*z[46]+Ixy*z[19]*
  z[45]-z[161]*z[46]-Ixy*z[14]*z[43]-Iyy*z[12]*z[45]) - 0.5*pow(w,2)*z[22]*
  z[43]*z[46]*(z[161]*z[185]+Iyy*z[12]*z[187]+2*Ixy*z[13]*z[43]-z[154]*z[185]-
  Ixy*z[14]*z[186]-Ixy*z[19]*z[187]-2*Ixy*z[11]*z[13]*z[45]) - 0.5*pow(w,2)*
  z[11]*z[14]*z[44]*z[45]*(z[161]*z[185]+Iyy*z[12]*z[187]+2*Ixy*z[13]*z[43]-
  z[154]*z[185]-Ixy*z[14]*z[186]-Ixy*z[19]*z[187]-2*Ixy*z[11]*z[13]*z[45]) - 
  0.5*z[14]*z[186]*(Ixx*z[13]*z[108]+Ixx*z[17]*z[109]+Ixy*z[11]*z[109]+z[156]*
  z[114]+Ixx*z[14]*z[112]+Ixx*z[19]*z[110]-z[155]*z[114]-Ixx*z[13]*z[111]-Ixy*
  z[12]*z[110]) - z[11]*z[14]*z[45]*(Izz*z[14]*z[108]+z[16]*pow(w,2)*z[46]*(
  z[154]*z[46]+Ixy*z[19]*z[45]-z[161]*z[46]-Ixy*z[14]*z[43]-Iyy*z[12]*z[45])-
  Izz*z[18]*z[109]-Izz*z[113]-Izz*z[13]*z[112]-Izz*z[14]*z[111]-Izz*z[20]*
  z[110]) - 0.5*z[19]*z[187]*(Ixx*z[13]*z[108]+Ixx*z[17]*z[109]+Ixy*z[11]*
  z[109]+pow(w,2)*z[44]*(z[154]*z[46]+Ixy*z[19]*z[45]-Ixy*z[14]*z[43]-Iyy*
  z[12]*z[45])+z[156]*z[114]+Ixx*z[14]*z[112]+Ixx*z[19]*z[110]-z[155]*z[114]-
  2*Ixy*z[12]*z[110]-Ixx*z[13]*z[111]) - z[11]*z[13]*z[45]*(Ixx*z[13]*z[108]+
  Ixx*z[17]*z[109]+Ixy*z[11]*z[109]+pow(w,2)*z[44]*(z[154]*z[46]+Ixy*z[19]*
  z[45]-Ixy*z[14]*z[43]-Iyy*z[12]*z[45])+z[156]*z[114]+Ixx*z[14]*z[112]+Ixx*
  z[19]*z[110]-z[155]*z[114]-2*Ixy*z[12]*z[110]-Ixx*z[13]*z[111]) - 0.25*
  z[12]*z[45]*(4*Ixy*z[14]*z[108]+z[154]*z[279]+2*Ixy*z[13]*z[283]-4*Ixy*
  z[13]*z[262]-4*Ixy*z[17]*z[263]-4*Iyy*z[11]*z[263]-4*Ixy*z[12]*z[13]*z[109]-
  z[161]*z[279]-4*Ixy*z[13]*z[112]-4*Ixy*z[14]*z[111]-Ixy*z[14]*z[282]-Iyy*
  z[12]*z[286]) - 0.5*z[15]*z[185]*(Ixy*z[13]*z[108]+Ixy*z[17]*z[109]+Iyy*
  z[11]*z[109]+Izz*pow(w,2)*z[19]*z[45]*(z[44]+z[13]*z[43]-z[20]*z[45])+Ixy*
  z[14]*z[112]+Ixy*z[19]*z[110]-Izz*pow(w,2)*z[14]*z[43]*(z[44]+z[13]*z[43]-
  z[20]*z[45])-z[154]*z[114]-Ixy*z[13]*z[111]-Iyy*z[12]*z[110]) - 0.25*z[14]*
  z[43]*(4*Ixx*z[14]*z[108]+z[155]*z[279]+Ixx*z[19]*z[286]+2*Ixx*z[13]*z[283]-
  4*Ixx*z[13]*z[262]-4*Ixx*z[17]*z[263]-4*Ixy*z[11]*z[263]-4*Ixx*z[12]*z[13]*
  z[109]-z[156]*z[279]-4*Ixx*z[13]*z[112]-4*Ixx*z[14]*z[111]-Ixx*z[14]*z[282]-
  Ixy*z[12]*z[286]-4*Ixx*z[11]*z[13]*z[110]) - 0.25*z[20]*z[45]*(4*Izz*z[18]*
  z[263]+2*z[16]*pow(w,2)*z[46]*(z[161]*z[185]+Iyy*z[12]*z[187]+2*Ixy*z[13]*
  z[43]-z[154]*z[185]-Ixy*z[14]*z[186]-Ixy*z[19]*z[187]-2*Ixy*z[11]*z[13]*
  z[45])+Izz*z[289]+Izz*z[13]*z[282]+2*Izz*z[14]*z[283]+4*Izz*z[13]*z[111]-4*
  Izz*z[13]*z[108]-4*Izz*z[14]*z[262]-4*Izz*z[12]*z[14]*z[109]-2*z[16]*pow(w,
  2)*z[185]*(z[154]*z[46]+Ixy*z[19]*z[45]-z[161]*z[46]-Ixy*z[14]*z[43]-Iyy*
  z[12]*z[45])-4*Izz*z[14]*z[112]-Izz*z[20]*z[286]-4*Izz*z[11]*z[14]*z[110]) - 
  0.25*z[16]*z[46]*(4*Ixx*z[14]*z[108]+2*Ixy*pow(w,2)*z[19]*z[45]*z[189]+2*
  Izz*pow(w,2)*z[12]*z[45]*(z[189]+z[13]*z[186]+z[20]*z[187]+2*z[14]*z[43]-2*
  z[11]*z[14]*z[45])+2*z[155]*z[279]+Ixx*z[19]*z[286]+2*Ixx*z[13]*z[283]-4*
  Ixx*z[13]*z[262]-4*Ixx*z[17]*z[263]-4*Ixy*z[11]*z[263]-4*Ixx*z[12]*z[13]*
  z[109]-2*Ixy*pow(w,2)*z[19]*z[44]*z[187]-4*Ixy*pow(w,2)*z[11]*z[13]*z[44]*
  z[45]-2*Izz*pow(w,2)*z[12]*z[187]*(z[44]+z[13]*z[43]-z[20]*z[45])-z[156]*
  z[279]-4*Ixx*z[13]*z[112]-4*Ixx*z[14]*z[111]-Ixx*z[14]*z[282]-Ixy*z[12]*
  z[286]-4*Ixx*z[11]*z[13]*z[110]);
  z[316] = z[45]*(z[12]*z[68]+z[18]*z[69]-z[24]*z[70]) + z[67]*(z[12]*z[43]+
  z[18]*z[44]-z[24]*z[46]);
  z[317] = z[45]*(z[14]*z[69]-z[22]*z[70]) + z[67]*(z[14]*z[44]-z[22]*z[46]);
  z[318] = 0.5*z[54]*z[106] + 0.5*z[57]*z[107] + 0.5*z[104]*q2p + 0.5*z[105]*
  q3p;
  z[319] = 0.5*z[54]*z[98] + 0.5*z[57]*z[99] + 0.5*z[96]*q2p + 0.5*z[97]*q3p;
  z[320] = z[57]*z[68] + z[43]*q3p;
  z[321] = -0.5*z[54]*z[94] - 0.5*z[57]*z[95] - 0.5*z[92]*q2p - 0.5*z[93]*q3p;
  z[322] = 0.5*z[54]*z[102] + 0.5*z[57]*z[103] + 0.5*z[100]*q2p + 0.5*z[101]*
  q3p;
  z[323] = w*z[66]*(z[20]*z[45]-z[44]-z[38]*z[43]);
  z[324] = w*z[11]*z[45]*z[65];
  z[325] = w*(z[15]*z[46]*z[64]-z[16]*z[46]*z[65]-z[12]*z[45]*z[64]);
  z[326] = w*z[66]*(z[26]*z[45]-z[46]-z[37]*z[43]);
  z[327] = -0.5*z[54]*z[141] - 0.5*z[57]*z[142] - 0.5*z[139]*q2p - 0.5*z[140]*
  q3p;
  z[328] = 0.5*z[57]*z[138] + 2*w*z[44]*z[64] + 2*w*z[13]*z[43]*z[64] + 0.5*
  z[136]*q3p - 0.5*z[54]*z[137] - 2*w*z[20]*z[45]*z[64] - 0.5*z[135]*q2p;
  z[329] = 0.5*z[57]*z[134] + 2*w*z[44]*z[65] + 0.5*z[132]*q3p - 0.5*z[54]*
  z[133] - 2*w*z[44]*z[63] - 0.5*z[131]*q2p;
  z[330] = 2*w*z[43]*z[65] + 2*w*z[11]*z[45]*z[63] - 0.5*z[54]*z[124] - 0.5*
  z[57]*z[125] - 2*w*z[43]*z[63] - 2*w*z[37]*z[46]*z[63] - 0.5*z[122]*q2p - 
  0.5*z[123]*q3p;
  z[331] = 0.5*z[54]*z[129] + 0.5*z[57]*z[130] + 2*w*z[43]*z[62] + 2*w*z[13]*
  z[44]*z[62] + 2*w*z[37]*z[46]*z[62] + 0.5*z[127]*q2p + 0.5*z[128]*q3p;
  z[332] = -z[57]*z[115] - 2*w*z[22]*z[46]*z[63] - 2*w*z[34]*z[46]*z[62] - 
  z[62]*q3p;
  z[333] = 2*Izz*w*z[36]*z[43]*z[46]*(z[44]+z[13]*z[43]-z[20]*z[45]) + 2*w*
  z[22]*z[43]*z[46]*(z[154]*z[46]+Ixy*z[19]*z[45]-z[161]*z[46]-Ixy*z[14]*
  z[43]-Iyy*z[12]*z[45]) + 2*w*z[11]*z[14]*z[44]*z[45]*(z[154]*z[46]+Ixy*
  z[19]*z[45]-z[161]*z[46]-Ixy*z[14]*z[43]-Iyy*z[12]*z[45]) + z[12]*z[45]*(
  Ixy*z[13]*z[316]+Ixy*z[17]*z[317]+Iyy*z[11]*z[317]+z[161]*z[318]+Ixy*z[14]*
  z[319]-z[154]*z[318]-Ixy*z[13]*z[320]-Iyy*z[12]*z[321]) + z[14]*z[43]*(Ixx*
  z[13]*z[316]+Ixx*z[17]*z[317]+Ixy*z[11]*z[317]+z[156]*z[318]+Ixx*z[14]*
  z[319]+Ixx*z[19]*z[321]-z[155]*z[318]-Ixx*z[13]*z[320]-Ixy*z[12]*z[321]) + 
  z[20]*z[45]*(Izz*z[14]*z[316]+2*z[16]*w*z[46]*(z[154]*z[46]+Ixy*z[19]*z[45]-
  z[161]*z[46]-Ixy*z[14]*z[43]-Iyy*z[12]*z[45])-Izz*z[18]*z[317]-Izz*z[322]-
  Izz*z[13]*z[319]-Izz*z[14]*z[320]-Izz*z[20]*z[321]) + z[16]*z[46]*(Ixx*
  z[13]*z[316]+Ixx*z[17]*z[317]+Ixy*z[11]*z[317]+2*Ixy*w*z[19]*z[44]*z[45]+2*
  Izz*w*z[12]*z[45]*(z[44]+z[13]*z[43]-z[20]*z[45])+z[156]*z[318]+Ixx*z[14]*
  z[319]+Ixx*z[19]*z[321]-2*z[155]*z[318]-Ixx*z[13]*z[320]-Ixy*z[12]*z[321]) - 
  2*Izz*w*z[25]*z[45]*z[46]*(z[44]+z[13]*z[43]-z[20]*z[45]) - 2*w*z[11]*z[22]*
  z[45]*z[46]*(z[154]*z[46]+Ixy*z[19]*z[45]-z[161]*z[46]-Ixy*z[14]*z[43]-Iyy*
  z[12]*z[45]) - Izz*z[44]*(z[14]*z[316]-z[18]*z[317]-z[322]-z[13]*z[319]-
  z[14]*z[320]-z[20]*z[321]) - z[13]*z[43]*(Izz*z[14]*z[316]+2*z[16]*w*z[46]*(
  z[154]*z[46]+Ixy*z[19]*z[45]-z[161]*z[46]-Ixy*z[14]*z[43]-Iyy*z[12]*z[45])-
  Izz*z[18]*z[317]-Izz*z[322]-Izz*z[13]*z[319]-Izz*z[14]*z[320]-Izz*z[20]*
  z[321]) - z[19]*z[45]*(Ixx*z[13]*z[316]+Ixx*z[17]*z[317]+Ixy*z[11]*z[317]+2*
  w*z[44]*(z[154]*z[46]+Ixy*z[19]*z[45]-Ixy*z[14]*z[43]-Iyy*z[12]*z[45])+
  z[156]*z[318]+Ixx*z[14]*z[319]+Ixx*z[19]*z[321]-z[155]*z[318]-2*Ixy*z[12]*
  z[321]-Ixx*z[13]*z[320]) - z[15]*z[46]*(Ixy*z[13]*z[316]+Ixy*z[17]*z[317]+
  Iyy*z[11]*z[317]+2*Izz*w*z[19]*z[45]*(z[44]+z[13]*z[43]-z[20]*z[45])+Ixy*
  z[14]*z[319]+Ixy*z[19]*z[321]-2*Izz*w*z[14]*z[43]*(z[44]+z[13]*z[43]-z[20]*
  z[45])-z[154]*z[318]-Ixy*z[13]*z[320]-Iyy*z[12]*z[321]) - m*(2*z[157]*z[12]*
  z[45]*z[323]+2*k*z[12]*z[13]*z[45]*z[324]+2*ra*z[12]*z[22]*z[45]*z[323]+2*k*
  w*z[12]*z[17]*z[62]*pow(z[45],2)+2*ra*z[324]*(z[12]*z[45]-z[34]*z[46])+2*
  z[158]*z[323]*(z[14]*z[43]-z[19]*z[45])+2*ra*z[14]*z[325]*(z[12]*z[45]-
  z[34]*z[46])+2*ra*z[14]*z[326]*(z[12]*z[45]-z[34]*z[46])+2*ra*z[35]*z[326]*(
  z[14]*z[44]-z[22]*z[46])+2*ra*w*z[11]*z[45]*z[62]*(z[14]*z[44]-z[22]*z[46])+
  k*z[46]*z[327]+z[157]*z[46]*z[328]+z[158]*z[46]*z[329]+k*z[21]*z[46]*z[330]+
  k*z[33]*z[46]*z[331]+k*z[36]*z[46]*z[332]+k*z[12]*z[14]*z[45]*z[332]+k*(
  z[14]*z[43]-z[19]*z[45])*z[328]+k*(z[14]*z[43]-z[19]*z[45])*z[331]+z[157]*(
  z[14]*z[43]-z[19]*z[45])*z[327]-2*k*z[21]*z[46]*z[324]-2*ra*z[14]*z[34]*
  z[44]*z[323]-2*k*w*z[23]*z[45]*z[46]*z[62]-2*k*w*z[11]*z[45]*z[62]*(z[14]*
  z[43]-z[19]*z[45])-k*z[12]*z[45]*z[329]-z[158]*z[12]*z[45]*z[327]-k*z[12]*
  z[13]*z[45]*z[330]-ra*(z[12]*z[45]-z[34]*z[46])*z[330]-ra*(z[14]*z[44]-
  z[22]*z[46])*z[328]-ra*(z[14]*z[44]-z[22]*z[46])*z[331]-ra*z[13]*(z[12]*
  z[45]-z[34]*z[46])*z[329]-ra*z[21]*(z[12]*z[45]-z[34]*z[46])*z[327]-ra*
  z[33]*(z[14]*z[44]-z[22]*z[46])*z[327]);
  ke = 0.5*pow(w,2)*(Iyy*pow(z[12],2)*pow(z[45],2)+Izz*pow(z[20],2)*pow(z[45],
  2)+Izz*z[13]*z[43]*(z[13]*z[43]-2*z[20]*z[45])+Izz*z[44]*(z[44]+2*z[13]*
  z[43]-2*z[20]*z[45])+z[14]*z[43]*(Ixx*z[14]*z[43]+2*Ixy*z[12]*z[45])+z[16]*
  z[46]*(Ixx*z[16]*z[46]+2*Ixx*z[14]*z[43]+2*Ixy*z[12]*z[45])+z[19]*z[45]*(
  Ixx*z[19]*z[45]-2*Ixx*z[16]*z[46]-2*Ixx*z[14]*z[43]-2*Ixy*z[12]*z[45])+
  z[15]*z[46]*(Iyy*z[15]*z[46]+2*Ixy*z[19]*z[45]-2*Ixy*z[16]*z[46]-2*Ixy*
  z[14]*z[43]-2*Iyy*z[12]*z[45])+m*(pow(z[62],2)+pow(z[63],2)+pow(z[64],2)+
  pow(z[65],2)+pow(z[66],2)+2*z[16]*z[65]*z[66]+2*z[13]*z[62]*z[64]-2*z[63]*
  z[65]-2*z[15]*z[64]*z[66]-2*z[21]*z[62]*z[66]-2*z[33]*z[63]*z[66]));
  pe = g*m*(k*z[20]+ra*z[11]);
  te = ke + pe;
  w1 = w*(z[16]*z[46]+z[14]*z[43]-z[19]*z[45]);
  w2 = -w*(z[15]*z[46]-z[12]*z[45]);
  w3 = -w*(z[44]+z[13]*z[43]-z[20]*z[45]);
  z[351] = z[9]*z[13] - z[14]*z[60];
  z[352] = z[10]*z[13] + z[14]*z[61];
  z[353] = z[9]*z[14] + z[13]*z[60];
  z[354] = z[10]*z[14] - z[13]*z[61];
  z[355] = z[15]*z[351] - z[16]*z[58];
  z[356] = z[15]*z[352] + z[16]*z[59];
  z[357] = -z[15]*z[58] - z[16]*z[351];
  z[358] = z[15]*z[59] - z[16]*z[352];
  z[359] = z[1]*z[351] + z[2]*z[352];
  z[360] = z[2]*z[59] - z[1]*z[58];
  z[361] = z[1]*z[353] + z[2]*z[354];
  z[362] = z[4]*z[351] + z[6]*z[19] - z[5]*z[352];
  z[363] = -z[4]*z[58] - z[5]*z[59] - z[6]*z[12];
  z[364] = z[4]*z[353] - z[5]*z[354] - z[6]*z[20];
  z[365] = z[3]*z[19] + z[8]*z[352] - z[7]*z[351];
  z[366] = z[7]*z[58] + z[8]*z[59] - z[3]*z[12];
  z[367] = z[8]*z[354] - z[3]*z[20] - z[7]*z[353];
  z[371] = z[13]*z[361] - z[14]*z[359];
  z[372] = z[13]*z[364] - z[14]*z[362];
  z[373] = z[13]*z[367] - z[14]*z[365];
  z[374] = z[1]*z[355] + z[2]*z[356];
  z[375] = z[1]*z[357] + z[2]*z[358];
  z[376] = z[4]*z[355] - z[5]*z[356] - z[6]*z[25];
  z[377] = z[4]*z[357] - z[5]*z[358] - z[6]*z[26];
  z[378] = z[8]*z[356] - z[3]*z[25] - z[7]*z[355];
  z[379] = z[8]*z[358] - z[3]*z[26] - z[7]*z[357];
  z[380] = z[1]*z[9] + z[2]*z[10];
  z[381] = z[2]*z[9] - z[1]*z[10];
  z[382] = z[4]*z[9] - z[5]*z[10];
  z[383] = -z[4]*z[10] - z[5]*z[9];
  z[384] = z[8]*z[10] - z[7]*z[9];
  z[385] = z[7]*z[10] + z[8]*z[9];

  no_cb[0] = q4 - l*z[353] - ra*z[60] - z[32]*z[357];
  no_cb[1] = q5 + ra*z[61] - l*z[354] - z[32]*z[358];
  no_cb[2] = z[31] - l*z[20] - ra*z[11] - z[26]*z[32];
  no_so[0] = q4 - k*z[353] - ra*z[60];
  no_so[1] = q5 + ra*z[61] - k*z[354];
  no_so[2] = -k*z[20] - ra*z[11];
  a_so[0] = z[44]*z[150] + z[44]*z[153] + z[13]*z[43]*z[150] + z[14]*z[44]*
  z[143] + z[24]*z[46]*z[144] + z[26]*z[45]*z[152] + z[38]*z[43]*z[153] + 
  z[11]*z[45]*z[147] + z[12]*z[45]*(z[65]*wp+z[149]) + z[25]*z[45]*(z[66]*wp+
  z[151]) + z[14]*z[44]*(z[62]*wp-z[145]) + z[19]*z[45]*(z[64]*wp-z[148]) + 
  z[34]*z[46]*(z[63]*wp-z[146]) - z[46]*z[152] - z[12]*z[43]*z[144] - z[18]*
  z[44]*z[144] - z[20]*z[45]*z[150] - z[20]*z[45]*z[153] - z[22]*z[46]*z[143] - 
  z[37]*z[43]*z[152] - z[43]*z[147] - z[13]*z[44]*z[147] - z[37]*z[46]*z[147] - 
  z[15]*z[46]*(z[65]*wp+z[149]) - z[36]*z[43]*(z[66]*wp+z[151]) - z[16]*z[46]*(
  z[64]*wp-z[148]) - z[12]*z[45]*(z[63]*wp-z[146]) - z[14]*z[43]*(z[64]*wp-
  z[148]) - z[22]*z[46]*(z[62]*wp-z[145]);
  a_so[1] = z[12]*z[43]*z[143] + z[25]*z[46]*z[150] + z[25]*z[46]*z[153] + 
  z[16]*z[12]*z[44]*z[152] + z[11]*z[19]*z[44]*z[144] + z[12]*z[13]*z[44]*
  z[143] + z[12]*z[14]*z[43]*z[150] + z[12]*z[14]*z[43]*z[153] + z[12]*z[17]*
  z[44]*z[144] + z[12]*z[22]*z[43]*z[152] + z[14]*z[25]*z[46]*z[143] + z[12]*
  z[14]*z[44]*z[147] + z[20]*z[36]*z[46]*z[147] + z[20]*z[46]*(z[66]*wp+
  z[151]) + z[16]*z[20]*z[46]*(z[65]*wp+z[149]) + z[12]*z[43]*(z[62]*wp-
  z[145]) + z[12]*z[44]*(z[64]*wp-z[148]) + z[19]*z[44]*(z[63]*wp-z[146]) + 
  z[12]*z[13]*z[43]*(z[64]*wp-z[148]) + z[12]*z[13]*z[44]*(z[62]*wp-z[145]) + 
  z[14]*z[25]*z[46]*(z[62]*wp-z[145]) + z[25]*z[35]*z[46]*(z[63]*wp-z[146]) - 
  z[15]*z[19]*z[44]*z[152] - z[18]*z[25]*z[46]*z[144] - z[20]*z[21]*z[46]*
  z[143] - z[20]*z[23]*z[46]*z[144] - z[25]*z[38]*z[46]*z[147] - z[19]*z[44]*(
  z[65]*wp+z[149]) - z[15]*z[12]*z[44]*(z[66]*wp+z[151]) - z[16]*z[19]*z[44]*(
  z[66]*wp+z[151]) - z[12]*z[21]*z[43]*(z[66]*wp+z[151]) - z[15]*z[20]*z[46]*(
  z[64]*wp-z[148]) - z[20]*z[21]*z[46]*(z[62]*wp-z[145]) - z[20]*z[33]*z[46]*(
  z[63]*wp-z[146]);
  a_so[2] = z[26]*z[152] + z[11]*z[147] + z[12]*(z[65]*wp+z[149]) + z[25]*(
  z[66]*wp+z[151]) + z[19]*(z[64]*wp-z[148]) - z[20]*z[150] - z[20]*z[153] - 
  z[12]*(z[63]*wp-z[146]);
  H[0] = w*(Iyy*pow(z[12],2)*pow(z[45],2)+Izz*pow(z[20],2)*pow(z[45],2)+Izz*
  z[13]*z[43]*(z[13]*z[43]-2*z[20]*z[45])+Izz*z[44]*(z[44]+2*z[13]*z[43]-2*
  z[20]*z[45])+z[14]*z[43]*(Ixx*z[14]*z[43]+2*Ixy*z[12]*z[45])+z[16]*z[46]*(
  Ixx*z[16]*z[46]+2*Ixx*z[14]*z[43]+2*Ixy*z[12]*z[45])+z[19]*z[45]*(Ixx*z[19]*
  z[45]-2*Ixx*z[16]*z[46]-2*Ixx*z[14]*z[43]-2*Ixy*z[12]*z[45])+z[15]*z[46]*(
  Iyy*z[15]*z[46]+2*Ixy*z[19]*z[45]-2*Ixy*z[16]*z[46]-2*Ixy*z[14]*z[43]-2*Iyy*
  z[12]*z[45]));
  H[1] = -w*(z[15]*z[20]*z[46]*(Ixx*z[19]*z[45]+Ixy*z[15]*z[46]-Ixx*z[16]*
  z[46]-Ixx*z[14]*z[43]-Ixy*z[12]*z[45])+z[16]*z[20]*z[46]*(Ixy*z[19]*z[45]+
  Iyy*z[15]*z[46]-Ixy*z[16]*z[46]-Ixy*z[14]*z[43]-Iyy*z[12]*z[45])-Izz*z[25]*
  z[46]*(z[44]+z[13]*z[43]-z[20]*z[45])-Izz*z[12]*z[14]*z[43]*(z[44]+z[13]*
  z[43]-z[20]*z[45])-z[12]*z[44]*(Ixx*z[19]*z[45]+Ixy*z[15]*z[46]-Ixx*z[16]*
  z[46]-Ixx*z[14]*z[43]-Ixy*z[12]*z[45])-z[19]*z[44]*(Ixy*z[19]*z[45]+Iyy*
  z[15]*z[46]-Ixy*z[16]*z[46]-Ixy*z[14]*z[43]-Iyy*z[12]*z[45])-z[12]*z[13]*
  z[43]*(Ixx*z[19]*z[45]+Ixy*z[15]*z[46]-Ixx*z[16]*z[46]-Ixx*z[14]*z[43]-Ixy*
  z[12]*z[45]));
  H[2] = -w*(Izz*z[20]*(z[44]+z[13]*z[43]-z[20]*z[45])+z[12]*(Iyy*z[15]*z[46]-
  Ixy*z[16]*z[46]-Ixy*z[14]*z[43]-Iyy*z[12]*z[45])-z[19]*(Ixx*z[19]*z[45]+Ixy*
  z[15]*z[46]-2*Ixy*z[12]*z[45]-Ixx*z[16]*z[46]-Ixx*z[14]*z[43]));
  p[0] = m*w*(z[12]*z[45]*z[65]+z[14]*z[44]*z[62]+z[19]*z[45]*z[64]+z[25]*
  z[45]*z[66]+z[34]*z[46]*z[63]-z[15]*z[46]*z[65]-z[16]*z[46]*z[64]-z[12]*
  z[45]*z[63]-z[14]*z[43]*z[64]-z[22]*z[46]*z[62]-z[36]*z[43]*z[66]);
  p[1] = -m*w*(z[19]*z[44]*z[65]+z[15]*z[12]*z[44]*z[66]+z[15]*z[20]*z[46]*
  z[64]+z[16]*z[19]*z[44]*z[66]+z[12]*z[21]*z[43]*z[66]+z[20]*z[21]*z[46]*
  z[62]+z[20]*z[33]*z[46]*z[63]-z[12]*z[43]*z[62]-z[12]*z[44]*z[64]-z[19]*
  z[44]*z[63]-z[20]*z[46]*z[66]-z[16]*z[20]*z[46]*z[65]-z[12]*z[13]*z[43]*
  z[64]-z[12]*z[13]*z[44]*z[62]-z[14]*z[25]*z[46]*z[62]-z[25]*z[35]*z[46]*
  z[63]);
  p[2] = -m*w*(z[12]*z[63]-z[12]*z[65]-z[19]*z[64]-z[25]*z[66]);
  T_da[0] = z[359];
  T_da[1] = z[362];
  T_da[2] = z[365];
  T_da[3] = 0;
  T_da[4] = z[360];
  T_da[5] = z[363];
  T_da[6] = z[366];
  T_da[7] = 0;
  T_da[8] = z[361];
  T_da[9] = z[364];
  T_da[10] = z[367];
  T_da[11] = 0;
  T_da[12] = -z[1]*(ctx-q4) - z[2]*(cty-q5) - ra*z[371];
  T_da[13] = ctz*z[6] + z[5]*(cty-q5) - z[4]*(ctx-q4) - ra*z[372];
  T_da[14] = ctz*z[3] + z[7]*(ctx-q4) - d - z[8]*(cty-q5) - ra*z[373];
  T_da[15] = 1;
  T_db[0] = z[374];
  T_db[1] = z[376];
  T_db[2] = z[378];
  T_db[3] = 0;
  T_db[4] = z[375];
  T_db[5] = z[377];
  T_db[6] = z[379];
  T_db[7] = 0;
  T_db[8] = z[361];
  T_db[9] = z[364];
  T_db[10] = z[367];
  T_db[11] = 0;
  T_db[12] = -z[1]*(ctx-q4) - z[2]*(cty-q5) - l*z[361] - ra*z[371];
  T_db[13] = ctz*z[6] + z[5]*(cty-q5) - z[4]*(ctx-q4) - l*z[364] - ra*z[372];
  T_db[14] = ctz*z[3] + z[7]*(ctx-q4) - d - z[8]*(cty-q5) - l*z[367] - ra*
  z[373];
  T_db[15] = 1;
  T_so[0] = z[359];
  T_so[1] = z[362];
  T_so[2] = z[365];
  T_so[3] = 0;
  T_so[4] = z[360];
  T_so[5] = z[363];
  T_so[6] = z[366];
  T_so[7] = 0;
  T_so[8] = z[361];
  T_so[9] = z[364];
  T_so[10] = z[367];
  T_so[11] = 0;
  T_so[12] = -z[1]*(ctx-q4) - z[2]*(cty-q5) - k*z[361] - ra*z[371];
  T_so[13] = ctz*z[6] + z[5]*(cty-q5) - z[4]*(ctx-q4) - k*z[364] - ra*z[372];
  T_so[14] = ctz*z[3] + z[7]*(ctx-q4) - d - z[8]*(cty-q5) - k*z[367] - ra*
  z[373];
  T_so[15] = 1;
  T_ca[0] = z[380];
  T_ca[1] = z[382];
  T_ca[2] = z[384];
  T_ca[3] = 0;
  T_ca[4] = z[381];
  T_ca[5] = z[383];
  T_ca[6] = z[385];
  T_ca[7] = 0;
  T_ca[8] = 0;
  T_ca[9] = -z[6];
  T_ca[10] = -z[3];
  T_ca[11] = 0;
  T_ca[12] = -z[1]*(ctx-q4) - z[2]*(cty-q5);
  T_ca[13] = ctz*z[6] + z[5]*(cty-q5) - z[4]*(ctx-q4);
  T_ca[14] = ctz*z[3] + z[7]*(ctx-q4) - d - z[8]*(cty-q5);
  T_ca[15] = 1;
  T_cb[0] = z[50]*(z[20]*z[374]-z[25]*z[361]);
  T_cb[1] = z[50]*(z[20]*z[376]-z[25]*z[364]);
  T_cb[2] = z[50]*(z[20]*z[378]-z[25]*z[367]);
  T_cb[3] = 0;
  T_cb[4] = -z[50]*(z[20]*z[26]*z[361]+z[25]*z[26]*z[374]-z[375]*(pow(z[20],2)+
  pow(z[25],2)));
  T_cb[5] = -z[50]*(z[20]*z[26]*z[364]+z[25]*z[26]*z[376]-z[377]*(pow(z[20],2)+
  pow(z[25],2)));
  T_cb[6] = -z[50]*(z[20]*z[26]*z[367]+z[25]*z[26]*z[378]-z[379]*(pow(z[20],2)+
  pow(z[25],2)));
  T_cb[7] = 0;
  T_cb[8] = 0;
  T_cb[9] = -z[6];
  T_cb[10] = -z[3];
  T_cb[11] = 0;
  T_cb[12] = -z[1]*(ctx-q4) - z[2]*(cty-q5) - l*z[361] - ra*z[371] - z[32]*
  z[375];
  T_cb[13] = ctz*z[6] + z[5]*(cty-q5) - z[4]*(ctx-q4) - l*z[364] - ra*z[372] - 
  z[6]*z[31] - z[32]*z[377];
  T_cb[14] = ctz*z[3] + z[7]*(ctx-q4) - d - z[8]*(cty-q5) - l*z[367] - ra*
  z[373] - z[3]*z[31] - z[32]*z[379];
  T_cb[15] = 1;
  T_dagl[0] = z[359];
  T_dagl[1] = z[362];
  T_dagl[2] = z[365];
  T_dagl[3] = 0;
  T_dagl[4] = -z[361];
  T_dagl[5] = -z[364];
  T_dagl[6] = -z[367];
  T_dagl[7] = 0;
  T_dagl[8] = z[360];
  T_dagl[9] = z[363];
  T_dagl[10] = z[366];
  T_dagl[11] = 0;
  T_dagl[12] = -z[1]*(ctx-q4) - z[2]*(cty-q5) - ra*z[371];
  T_dagl[13] = ctz*z[6] + z[5]*(cty-q5) - z[4]*(ctx-q4) - ra*z[372];
  T_dagl[14] = ctz*z[3] + z[7]*(ctx-q4) - d - z[8]*(cty-q5) - ra*z[373];
  T_dagl[15] = 1;
  T_dbgl[0] = z[374];
  T_dbgl[1] = z[376];
  T_dbgl[2] = z[378];
  T_dbgl[3] = 0;
  T_dbgl[4] = -z[361];
  T_dbgl[5] = -z[364];
  T_dbgl[6] = -z[367];
  T_dbgl[7] = 0;
  T_dbgl[8] = z[375];
  T_dbgl[9] = z[377];
  T_dbgl[10] = z[379];
  T_dbgl[11] = 0;
  T_dbgl[12] = -z[1]*(ctx-q4) - z[2]*(cty-q5) - l*z[361] - ra*z[371];
  T_dbgl[13] = ctz*z[6] + z[5]*(cty-q5) - z[4]*(ctx-q4) - l*z[364] - ra*
  z[372];
  T_dbgl[14] = ctz*z[3] + z[7]*(ctx-q4) - d - z[8]*(cty-q5) - l*z[367] - ra*
  z[373];
  T_dbgl[15] = 1;
  A << w*z[179],
       w*z[191],
       z[54],
       w*z[193],
       w*z[195],
       z[57],
       -0.5*(g*z[197]+2*z[259])/z[159],
       0.5*(g*z[260]-2*z[315])/z[159],
       -z[333]/z[159];
  if (faz > 0.0)
    tensile[0] = true;
  else
    tensile[0] = false;
  if (fbz > 0.0)
    tensile[1] = true;
  else
    tensile[1] = false;
} // computeOutputs()

void SlottedDiscs::setState(const double state[6])
{
  q1 = state[0];
  q2 = state[1];
  q3 = state[2];
  q4 = state[3];
  q5 = state[4];
  w = state[5];
} // setState()

void SlottedDiscs::setParameters(DiscParams * p)
{
  m = p->m;
  ra = p->ra;
  rb = p->rb;
  k = p->k;
  l = p->l;
  g = p->g;
  alpha = p->alpha;
  Ixx = p->Ixx;
  Iyy = p->Iyy;
  Izz = p->Izz;
  Ixy = p->Ixy;

  evalConstants();
} // setParameters()

double SlottedDiscs::hc(double q2, double q3) const
{
  return rb*pow((1-pow((cos(alpha)*sin(q2)+sin(alpha)*sin(q3)*cos(q2)),2)),0.5)
         - ra*cos(q2) - l*cos(q2)*cos(q3);
}

double SlottedDiscs::hc_dq2(double q2, double q3) const
{
  return ra*sin(q2) + l*sin(q2)*cos(q3) - rb*(cos(alpha)*sin(q2)+sin(alpha)*
  sin(q3)*cos(q2))*(cos(alpha)*cos(q2)-sin(alpha)*sin(q2)*sin(q3))/pow((1-
  pow((cos(alpha)*sin(q2)+sin(alpha)*sin(q3)*cos(q2)),2)),0.5);
}

double SlottedDiscs::hc_dq3(double q2, double q3) const
{
  return cos(q2)*(l*sin(q3)-rb*sin(alpha)*cos(q3)*(cos(alpha)*sin(q2)+sin(
  alpha)*sin(q3)*cos(q2))/pow((1-pow((cos(alpha)*sin(q2)+sin(alpha)*sin(q3)*
  cos(q2)),2)),0.5));
}
